{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"$rdf\"","webpack:///./src/vocab.js","webpack:///./node_modules/mustache/mustache.js","webpack:///./node_modules/rdfgraphnode/js/rdfa-processor-dirty-hack.js","webpack:///external \"fetch\"","webpack:///./node_modules/rdfgraphnode/js/GraphNode.js","webpack:///./src/rdf2h.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","$rdf","schema","suffix","sym","rdf","rdfs","foaf","rdf2h","factory","mustache","objectToString","toString","isArray","Array","isFunction","escapeRegExp","string","replace","hasProperty","obj","propName","_typeof","regExpTest","RegExp","test","nonSpaceRe","isWhitespace","re","testRegExp","entityMap","&","<",">","\"","'","/","`","=","whiteRe","spaceRe","equalsRe","curlyRe","tagRe","Scanner","this","tail","pos","Context","view","parentContext","cache",".","parent","Writer","eos","scan","match","index","substring","length","scanUntil","search","push","lookup","names","context","lookupHit","indexOf","split","clearCache","parse","template","tags","tokens","openingTagRe","closingTagRe","closingCurlyRe","sections","spaces","hasTag","nonSpace","stripSpace","pop","compileTags","tagsToCompile","Error","start","type","chr","token","openSection","scanner","valueLength","charAt","nestedTokens","collector","numTokens","nestTokens","lastToken","squashedTokens","squashTokens","parseTemplate","render","partials","renderTokens","originalTemplate","symbol","buffer","undefined","renderSection","renderInverted","renderPartial","unescapedValue","escapedValue","rawValue","self","j","slice","escape","version","defaultWriter","TypeError","to_html","send","result","String","nodeName","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","__WEBPACK_AMD_DEFINE_FACTORY__","apply","_createClass","defineProperties","target","props","descriptor","writable","key","Constructor","protoProps","staticProps","BlankNode","Literal","DataFactory","NamedNode","Uri","uri","Util","Node","ELEMENT_NODE","ATTRIBUTE_NODE","TEXT_NODE","CDATA_SECTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","PROCESSING_INSTRUCTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","NOTATION_NODE","RDFaProcessor","kb","options","instance","_classCallCheck","graph","subjects","prefixes","terms","blankNodes","htmlOptions","selfClosing","theOne","Date","getTime","language","vocabulary","blankCounter","langAttributes","namespaceURI","localName","inXHTMLMode","absURIRE","finishedHandlers","init","origin","subject","predicate","su","ob","pr","or","namedNode","base","toRDFNodeObject","add","node","path","nodeType","parentNode","mappings","newMappings","k","dateTimeTypes","matched","pattern","exec","colon","prefix","NCNAME","curie","parseCURIE","resolveAndNormalize","defaultVocabulary","ignoreTerms","parseTermOrCURIEOrAbsURI","str","values","tokenize","join","trim","parseCURIEOrURI","term","toLowerCase","baseURI","documentElement","setContext","queue","removeHash","hash","baseURIMap","current","item","shift","listMapping","_predicate","list","bnodes","_i","newBlankNode","_i2","addTriple","objectURI","skip","newSubject","currentObjectResource","typedResource","prefixesCopied","incomplete","listMappingDifferent","parseURI","vocabAtt","getAttributeNode","baseSubject","spec","attributes","att","copyMappings","ref","prefixAtt","parsePrefixMappings","xmlLangAtt","_i3","getAttributeNodeNS","_value","relAtt","revAtt","typeofAtt","propertyAtt","datatypeAtt","datetimeAtt","inHTMLMode","contentAtt","aboutAtt","srcAtt","resourceAtt","hrefAtt","inlistAtt","relAttPredicates","_i4","parsePredicate","revAttPredicates","_i5","parseSafeCURIEOrCURIEOrURI","parentObject","encodeURI","id","newSubjectOrigin","_i6","typeURI","_i7","_list","_i8","_i9","_i10","_list2","_i11","forward","_i12","datatype","content","PlainLiteralURI","XMLLiteralURI","HTMLLiteralURI","textContent","deriveDateTimeType","_i13","_predicate2","_list3","childNodes","_i14","childContext","listSubject","unshift","child","lastChild","previousSibling","copyProperties","_i15","getAttribute","setXHTMLContext","document","doctype","publicId","systemId","console","log","setHTMLContext","setXMLContext","setInitialContext","x","keys","forEach","domToString","dom","process","nameChar","nameStartChar","fetch","Headers","window","GraphNode","Function","bind","Impl","concat","arguments","_class","nodes","sources","_graph","_this","termType","Promise","resolve","rdfFetch","then","response","f","_this2","results","map","all","_this3","_this4","each","statementsMatching","statement","login","ggg","headers","set","ok","reject","mediaType","text","DOMParser","parseRDFaDOM","parseXML","contentType","error","plainFetch","status","Mustache","vocab","RDF2h","rendererGraph","tbox","env","origLokup","Renderee","resolvePath","pathSections","readingURI","lastCharLess","section","nextSection","splitPathSection","resolveSubPath","subNode","endsWith","in","resolveCurie","startsWith","out","resultNodes","equals","literal","graphNode","prefixPart","splits","iriPart","iri","prefixMap","subContext","nodePath","resolvedNodes","warn","getRenderer","renderee","types","sort","a","b","localeCompare","t","renderer","reduce","find","getMatchingRenderer","rendererRenderer","js","output","returnValue","err","message","stackLines","stack","lineWithSelf","findIndex","splice"],"mappings":"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","file":"js/rdf2h.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","module.exports = $rdf;","var $rdf = require(\"rdflib\");\n\nmodule.exports = {\n    schema: function (suffix) {\n        return $rdf.sym(\"http://schema.org/\" + suffix);\n    },\n    rdf: function (suffix) {\n        return $rdf.sym(\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\" + suffix);\n    },\n    rdfs: function (suffix) {\n        return $rdf.sym(\"http://www.w3.org/2000/01/rdf-schema#\" + suffix);\n    },\n    foaf: function (suffix) {\n        return $rdf.sym(\"http://xmlns.com/foaf/0.1/\" + suffix);\n    },\n    rdf2h: function(suffix) {\n        return $rdf.sym(\"http://rdf2h.github.io/2015/rdf2h#\"+suffix);\n    }\n}\n","/*!\n * mustache.js - Logic-less {{mustache}} templates with JavaScript\n * http://github.com/janl/mustache.js\n */\n\n/*global define: false Mustache: true*/\n\n(function defineMustache (global, factory) {\n  if (typeof exports === 'object' && exports && typeof exports.nodeName !== 'string') {\n    factory(exports); // CommonJS\n  } else if (typeof define === 'function' && define.amd) {\n    define(['exports'], factory); // AMD\n  } else {\n    global.Mustache = {};\n    factory(global.Mustache); // script, wsh, asp\n  }\n}(this, function mustacheFactory (mustache) {\n\n  var objectToString = Object.prototype.toString;\n  var isArray = Array.isArray || function isArrayPolyfill (object) {\n    return objectToString.call(object) === '[object Array]';\n  };\n\n  function isFunction (object) {\n    return typeof object === 'function';\n  }\n\n  /**\n   * More correct typeof string handling array\n   * which normally returns typeof 'object'\n   */\n  function typeStr (obj) {\n    return isArray(obj) ? 'array' : typeof obj;\n  }\n\n  function escapeRegExp (string) {\n    return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, '\\\\$&');\n  }\n\n  /**\n   * Null safe way of checking whether or not an object,\n   * including its prototype, has a given property\n   */\n  function hasProperty (obj, propName) {\n    return obj != null && typeof obj === 'object' && (propName in obj);\n  }\n\n  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577\n  // See https://github.com/janl/mustache.js/issues/189\n  var regExpTest = RegExp.prototype.test;\n  function testRegExp (re, string) {\n    return regExpTest.call(re, string);\n  }\n\n  var nonSpaceRe = /\\S/;\n  function isWhitespace (string) {\n    return !testRegExp(nonSpaceRe, string);\n  }\n\n  var entityMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '/': '&#x2F;',\n    '`': '&#x60;',\n    '=': '&#x3D;'\n  };\n\n  function escapeHtml (string) {\n    return String(string).replace(/[&<>\"'`=\\/]/g, function fromEntityMap (s) {\n      return entityMap[s];\n    });\n  }\n\n  var whiteRe = /\\s*/;\n  var spaceRe = /\\s+/;\n  var equalsRe = /\\s*=/;\n  var curlyRe = /\\s*\\}/;\n  var tagRe = /#|\\^|\\/|>|\\{|&|=|!/;\n\n  /**\n   * Breaks up the given `template` string into a tree of tokens. If the `tags`\n   * argument is given here it must be an array with two string values: the\n   * opening and closing tags used in the template (e.g. [ \"<%\", \"%>\" ]). Of\n   * course, the default is to use mustaches (i.e. mustache.tags).\n   *\n   * A token is an array with at least 4 elements. The first element is the\n   * mustache symbol that was used inside the tag, e.g. \"#\" or \"&\". If the tag\n   * did not contain a symbol (i.e. {{myValue}}) this element is \"name\". For\n   * all text that appears outside a symbol this element is \"text\".\n   *\n   * The second element of a token is its \"value\". For mustache tags this is\n   * whatever else was inside the tag besides the opening symbol. For text tokens\n   * this is the text itself.\n   *\n   * The third and fourth elements of the token are the start and end indices,\n   * respectively, of the token in the original template.\n   *\n   * Tokens that are the root node of a subtree contain two more elements: 1) an\n   * array of tokens in the subtree and 2) the index in the original template at\n   * which the closing tag for that section begins.\n   */\n  function parseTemplate (template, tags) {\n    if (!template)\n      return [];\n\n    var sections = [];     // Stack to hold section tokens\n    var tokens = [];       // Buffer to hold the tokens\n    var spaces = [];       // Indices of whitespace tokens on the current line\n    var hasTag = false;    // Is there a {{tag}} on the current line?\n    var nonSpace = false;  // Is there a non-space char on the current line?\n\n    // Strips all whitespace tokens array for the current line\n    // if there was a {{#tag}} on it and otherwise only space.\n    function stripSpace () {\n      if (hasTag && !nonSpace) {\n        while (spaces.length)\n          delete tokens[spaces.pop()];\n      } else {\n        spaces = [];\n      }\n\n      hasTag = false;\n      nonSpace = false;\n    }\n\n    var openingTagRe, closingTagRe, closingCurlyRe;\n    function compileTags (tagsToCompile) {\n      if (typeof tagsToCompile === 'string')\n        tagsToCompile = tagsToCompile.split(spaceRe, 2);\n\n      if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)\n        throw new Error('Invalid tags: ' + tagsToCompile);\n\n      openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\\\s*');\n      closingTagRe = new RegExp('\\\\s*' + escapeRegExp(tagsToCompile[1]));\n      closingCurlyRe = new RegExp('\\\\s*' + escapeRegExp('}' + tagsToCompile[1]));\n    }\n\n    compileTags(tags || mustache.tags);\n\n    var scanner = new Scanner(template);\n\n    var start, type, value, chr, token, openSection;\n    while (!scanner.eos()) {\n      start = scanner.pos;\n\n      // Match any text between tags.\n      value = scanner.scanUntil(openingTagRe);\n\n      if (value) {\n        for (var i = 0, valueLength = value.length; i < valueLength; ++i) {\n          chr = value.charAt(i);\n\n          if (isWhitespace(chr)) {\n            spaces.push(tokens.length);\n          } else {\n            nonSpace = true;\n          }\n\n          tokens.push([ 'text', chr, start, start + 1 ]);\n          start += 1;\n\n          // Check for whitespace on the current line.\n          if (chr === '\\n')\n            stripSpace();\n        }\n      }\n\n      // Match the opening tag.\n      if (!scanner.scan(openingTagRe))\n        break;\n\n      hasTag = true;\n\n      // Get the tag type.\n      type = scanner.scan(tagRe) || 'name';\n      scanner.scan(whiteRe);\n\n      // Get the tag value.\n      if (type === '=') {\n        value = scanner.scanUntil(equalsRe);\n        scanner.scan(equalsRe);\n        scanner.scanUntil(closingTagRe);\n      } else if (type === '{') {\n        value = scanner.scanUntil(closingCurlyRe);\n        scanner.scan(curlyRe);\n        scanner.scanUntil(closingTagRe);\n        type = '&';\n      } else {\n        value = scanner.scanUntil(closingTagRe);\n      }\n\n      // Match the closing tag.\n      if (!scanner.scan(closingTagRe))\n        throw new Error('Unclosed tag at ' + scanner.pos);\n\n      token = [ type, value, start, scanner.pos ];\n      tokens.push(token);\n\n      if (type === '#' || type === '^') {\n        sections.push(token);\n      } else if (type === '/') {\n        // Check section nesting.\n        openSection = sections.pop();\n\n        if (!openSection)\n          throw new Error('Unopened section \"' + value + '\" at ' + start);\n\n        if (openSection[1] !== value)\n          throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + start);\n      } else if (type === 'name' || type === '{' || type === '&') {\n        nonSpace = true;\n      } else if (type === '=') {\n        // Set the tags for the next time around.\n        compileTags(value);\n      }\n    }\n\n    // Make sure there are no open sections when we're done.\n    openSection = sections.pop();\n\n    if (openSection)\n      throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + scanner.pos);\n\n    return nestTokens(squashTokens(tokens));\n  }\n\n  /**\n   * Combines the values of consecutive text tokens in the given `tokens` array\n   * to a single token.\n   */\n  function squashTokens (tokens) {\n    var squashedTokens = [];\n\n    var token, lastToken;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      if (token) {\n        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {\n          lastToken[1] += token[1];\n          lastToken[3] = token[3];\n        } else {\n          squashedTokens.push(token);\n          lastToken = token;\n        }\n      }\n    }\n\n    return squashedTokens;\n  }\n\n  /**\n   * Forms the given array of `tokens` into a nested tree structure where\n   * tokens that represent a section have two additional items: 1) an array of\n   * all tokens that appear in that section and 2) the index in the original\n   * template that represents the end of that section.\n   */\n  function nestTokens (tokens) {\n    var nestedTokens = [];\n    var collector = nestedTokens;\n    var sections = [];\n\n    var token, section;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      switch (token[0]) {\n        case '#':\n        case '^':\n          collector.push(token);\n          sections.push(token);\n          collector = token[4] = [];\n          break;\n        case '/':\n          section = sections.pop();\n          section[5] = token[2];\n          collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;\n          break;\n        default:\n          collector.push(token);\n      }\n    }\n\n    return nestedTokens;\n  }\n\n  /**\n   * A simple string scanner that is used by the template parser to find\n   * tokens in template strings.\n   */\n  function Scanner (string) {\n    this.string = string;\n    this.tail = string;\n    this.pos = 0;\n  }\n\n  /**\n   * Returns `true` if the tail is empty (end of string).\n   */\n  Scanner.prototype.eos = function eos () {\n    return this.tail === '';\n  };\n\n  /**\n   * Tries to match the given regular expression at the current position.\n   * Returns the matched text if it can match, the empty string otherwise.\n   */\n  Scanner.prototype.scan = function scan (re) {\n    var match = this.tail.match(re);\n\n    if (!match || match.index !== 0)\n      return '';\n\n    var string = match[0];\n\n    this.tail = this.tail.substring(string.length);\n    this.pos += string.length;\n\n    return string;\n  };\n\n  /**\n   * Skips all text until the given regular expression can be matched. Returns\n   * the skipped string, which is the entire tail if no match can be made.\n   */\n  Scanner.prototype.scanUntil = function scanUntil (re) {\n    var index = this.tail.search(re), match;\n\n    switch (index) {\n      case -1:\n        match = this.tail;\n        this.tail = '';\n        break;\n      case 0:\n        match = '';\n        break;\n      default:\n        match = this.tail.substring(0, index);\n        this.tail = this.tail.substring(index);\n    }\n\n    this.pos += match.length;\n\n    return match;\n  };\n\n  /**\n   * Represents a rendering context by wrapping a view object and\n   * maintaining a reference to the parent context.\n   */\n  function Context (view, parentContext) {\n    this.view = view;\n    this.cache = { '.': this.view };\n    this.parent = parentContext;\n  }\n\n  /**\n   * Creates a new context using the given view with this context\n   * as the parent.\n   */\n  Context.prototype.push = function push (view) {\n    return new Context(view, this);\n  };\n\n  /**\n   * Returns the value of the given name in this context, traversing\n   * up the context hierarchy if the value is absent in this context's view.\n   */\n  Context.prototype.lookup = function lookup (name) {\n    var cache = this.cache;\n\n    var value;\n    if (cache.hasOwnProperty(name)) {\n      value = cache[name];\n    } else {\n      var context = this, names, index, lookupHit = false;\n\n      while (context) {\n        if (name.indexOf('.') > 0) {\n          value = context.view;\n          names = name.split('.');\n          index = 0;\n\n          /**\n           * Using the dot notion path in `name`, we descend through the\n           * nested objects.\n           *\n           * To be certain that the lookup has been successful, we have to\n           * check if the last object in the path actually has the property\n           * we are looking for. We store the result in `lookupHit`.\n           *\n           * This is specially necessary for when the value has been set to\n           * `undefined` and we want to avoid looking up parent contexts.\n           **/\n          while (value != null && index < names.length) {\n            if (index === names.length - 1)\n              lookupHit = hasProperty(value, names[index]);\n\n            value = value[names[index++]];\n          }\n        } else {\n          value = context.view[name];\n          lookupHit = hasProperty(context.view, name);\n        }\n\n        if (lookupHit)\n          break;\n\n        context = context.parent;\n      }\n\n      cache[name] = value;\n    }\n\n    if (isFunction(value))\n      value = value.call(this.view);\n\n    return value;\n  };\n\n  /**\n   * A Writer knows how to take a stream of tokens and render them to a\n   * string, given a context. It also maintains a cache of templates to\n   * avoid the need to parse the same template twice.\n   */\n  function Writer () {\n    this.cache = {};\n  }\n\n  /**\n   * Clears all cached templates in this writer.\n   */\n  Writer.prototype.clearCache = function clearCache () {\n    this.cache = {};\n  };\n\n  /**\n   * Parses and caches the given `template` and returns the array of tokens\n   * that is generated from the parse.\n   */\n  Writer.prototype.parse = function parse (template, tags) {\n    var cache = this.cache;\n    var tokens = cache[template];\n\n    if (tokens == null)\n      tokens = cache[template] = parseTemplate(template, tags);\n\n    return tokens;\n  };\n\n  /**\n   * High-level method that is used to render the given `template` with\n   * the given `view`.\n   *\n   * The optional `partials` argument may be an object that contains the\n   * names and templates of partials that are used in the template. It may\n   * also be a function that is used to load partial templates on the fly\n   * that takes a single argument: the name of the partial.\n   */\n  Writer.prototype.render = function render (template, view, partials) {\n    var tokens = this.parse(template);\n    var context = (view instanceof Context) ? view : new Context(view);\n    return this.renderTokens(tokens, context, partials, template);\n  };\n\n  /**\n   * Low-level method that renders the given array of `tokens` using\n   * the given `context` and `partials`.\n   *\n   * Note: The `originalTemplate` is only ever used to extract the portion\n   * of the original template that was contained in a higher-order section.\n   * If the template doesn't use higher-order sections, this argument may\n   * be omitted.\n   */\n  Writer.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate) {\n    var buffer = '';\n\n    var token, symbol, value;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      value = undefined;\n      token = tokens[i];\n      symbol = token[0];\n\n      if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate);\n      else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate);\n      else if (symbol === '>') value = this.renderPartial(token, context, partials, originalTemplate);\n      else if (symbol === '&') value = this.unescapedValue(token, context);\n      else if (symbol === 'name') value = this.escapedValue(token, context);\n      else if (symbol === 'text') value = this.rawValue(token);\n\n      if (value !== undefined)\n        buffer += value;\n    }\n\n    return buffer;\n  };\n\n  Writer.prototype.renderSection = function renderSection (token, context, partials, originalTemplate) {\n    var self = this;\n    var buffer = '';\n    var value = context.lookup(token[1]);\n\n    // This function is used to render an arbitrary template\n    // in the current context by higher-order sections.\n    function subRender (template) {\n      return self.render(template, context, partials);\n    }\n\n    if (!value) return;\n\n    if (isArray(value)) {\n      for (var j = 0, valueLength = value.length; j < valueLength; ++j) {\n        buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate);\n      }\n    } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {\n      buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate);\n    } else if (isFunction(value)) {\n      if (typeof originalTemplate !== 'string')\n        throw new Error('Cannot use higher-order sections without the original template');\n\n      // Extract the portion of the original template that the section contains.\n      value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);\n\n      if (value != null)\n        buffer += value;\n    } else {\n      buffer += this.renderTokens(token[4], context, partials, originalTemplate);\n    }\n    return buffer;\n  };\n\n  Writer.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate) {\n    var value = context.lookup(token[1]);\n\n    // Use JavaScript's definition of falsy. Include empty arrays.\n    // See https://github.com/janl/mustache.js/issues/186\n    if (!value || (isArray(value) && value.length === 0))\n      return this.renderTokens(token[4], context, partials, originalTemplate);\n  };\n\n  Writer.prototype.renderPartial = function renderPartial (token, context, partials) {\n    if (!partials) return;\n\n    var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];\n    if (value != null)\n      return this.renderTokens(this.parse(value), context, partials, value);\n  };\n\n  Writer.prototype.unescapedValue = function unescapedValue (token, context) {\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return value;\n  };\n\n  Writer.prototype.escapedValue = function escapedValue (token, context) {\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return mustache.escape(value);\n  };\n\n  Writer.prototype.rawValue = function rawValue (token) {\n    return token[1];\n  };\n\n  mustache.name = 'mustache.js';\n  mustache.version = '2.3.0';\n  mustache.tags = [ '{{', '}}' ];\n\n  // All high-level mustache.* functions use this writer.\n  var defaultWriter = new Writer();\n\n  /**\n   * Clears all cached templates in the default writer.\n   */\n  mustache.clearCache = function clearCache () {\n    return defaultWriter.clearCache();\n  };\n\n  /**\n   * Parses and caches the given template in the default writer and returns the\n   * array of tokens it contains. Doing this ahead of time avoids the need to\n   * parse templates on the fly as they are rendered.\n   */\n  mustache.parse = function parse (template, tags) {\n    return defaultWriter.parse(template, tags);\n  };\n\n  /**\n   * Renders the `template` with the given `view` and `partials` using the\n   * default writer.\n   */\n  mustache.render = function render (template, view, partials) {\n    if (typeof template !== 'string') {\n      throw new TypeError('Invalid template! Template should be a \"string\" ' +\n                          'but \"' + typeStr(template) + '\" was given as the first ' +\n                          'argument for mustache#render(template, view, partials)');\n    }\n\n    return defaultWriter.render(template, view, partials);\n  };\n\n  // This is here for backwards compatibility with 0.4.x.,\n  /*eslint-disable */ // eslint wants camel cased function name\n  mustache.to_html = function to_html (template, view, partials, send) {\n    /*eslint-enable*/\n\n    var result = mustache.render(template, view, partials);\n\n    if (isFunction(send)) {\n      send(result);\n    } else {\n      return result;\n    }\n  };\n\n  // Export the escaping function so that the user may override it.\n  // See https://github.com/janl/mustache.js/issues/244\n  mustache.escape = escapeHtml;\n\n  // Export these mainly for testing, but also for advanced usage.\n  mustache.Scanner = Scanner;\n  mustache.Context = Context;\n  mustache.Writer = Writer;\n\n  return mustache;\n}));\n","//The defaut version never worked, this works sometimes\r\n\r\n'use strict';\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n//  RDFa Parser for rdflib.js\r\n\r\n// Originally by: Alex Milowski\r\n// From https://github.com/alexmilowski/green-turtle\r\n// Converted: timbl 2015-08-25 not yet working\r\n// Added wrapper: csarven 2016-05-09 working\r\n\r\n// RDFaProcessor.prototype = new Object() // Was URIResolver\r\n\r\n// RDFaProcessor.prototype.constructor=RDFaProcessor\r\n\r\n// options.base = base URI    not really an option, shopuld always be set.\r\n//\r\nvar $rdf = require(\"rdflib\");\r\nvar BlankNode = $rdf.BlankNode;\r\nvar Literal = $rdf.Literal;\r\nvar rdf = $rdf.DataFactory;\r\nvar NamedNode = $rdf.NamedNode;\r\nvar Uri = $rdf.uri;\r\nvar Util = $rdf.Util;\r\n\r\nif (typeof Node === 'undefined') {\r\n  //  @@@@@@ Global. Interface to xmldom.\r\n  var Node = {\r\n    ELEMENT_NODE: 1,\r\n    ATTRIBUTE_NODE: 2,\r\n    TEXT_NODE: 3,\r\n    CDATA_SECTION_NODE: 4,\r\n    ENTITY_REFERENCE_NODE: 5,\r\n    ENTITY_NODE: 6,\r\n    PROCESSING_INSTRUCTION_NODE: 7,\r\n    COMMENT_NODE: 8,\r\n    DOCUMENT_NODE: 9,\r\n    DOCUMENT_TYPE_NODE: 10,\r\n    DOCUMENT_FRAGMENT_NODE: 11,\r\n    NOTATION_NODE: 12\r\n  };\r\n}\r\n\r\nvar RDFaProcessor = function () {\r\n  function RDFaProcessor(kb, options) {\r\n    _classCallCheck(this, RDFaProcessor);\r\n\r\n    this.options = options || {};\r\n    this.kb = kb;\r\n    this.target = options.target || {\r\n      graph: {\r\n        subjects: {},\r\n        prefixes: {},\r\n        terms: {}\r\n      }\r\n      // XXX: Added to track bnodes\r\n    };this.blankNodes = [];\r\n    // XXX: Added for normalisation\r\n    this.htmlOptions = {\r\n      'selfClosing': 'br img input area base basefont col colgroup source wbr isindex link meta param hr'\r\n    };\r\n    this.theOne = '_:' + new Date().getTime();\r\n    this.language = null;\r\n    this.vocabulary = null;\r\n    this.blankCounter = 0;\r\n    this.langAttributes = [{ namespaceURI: 'http://www.w3.org/XML/1998/namespace', localName: 'lang' }];\r\n    this.inXHTMLMode = false;\r\n    this.absURIRE = /[\\w\\_\\-]+:\\S+/;\r\n    this.finishedHandlers = [];\r\n    this.init();\r\n  }\r\n\r\n  _createClass(RDFaProcessor, [{\r\n    key: 'addTriple',\r\n    value: function addTriple(origin, subject, predicate, object) {\r\n      var su, ob, pr, or;\r\n      if (typeof subject === 'undefined') {\r\n        su = rdf.namedNode(this.options.base);\r\n      } else {\r\n        su = this.toRDFNodeObject(subject);\r\n      }\r\n      pr = this.toRDFNodeObject(predicate);\r\n      ob = this.toRDFNodeObject(object);\r\n      or = rdf.namedNode(this.options.base);\r\n      // console.log('Adding { ' + su + ' ' + pr + ' ' + ob + ' ' + or + ' }')\r\n      this.kb.add(su, pr, ob, or);\r\n    }\r\n  }, {\r\n    key: 'ancestorPath',\r\n    value: function ancestorPath(node) {\r\n      var path = '';\r\n      while (node && node.nodeType !== Node.DOCUMENT_NODE) {\r\n        path = '/' + node.localName + path;\r\n        node = node.parentNode;\r\n      }\r\n      return path;\r\n    }\r\n  }, {\r\n    key: 'copyMappings',\r\n    value: function copyMappings(mappings) {\r\n      var newMappings = {};\r\n      for (var k in mappings) {\r\n        newMappings[k] = mappings[k];\r\n      }\r\n      return newMappings;\r\n    }\r\n  }, {\r\n    key: 'copyProperties',\r\n    value: function copyProperties() {}\r\n  }, {\r\n    key: 'deriveDateTimeType',\r\n    value: function deriveDateTimeType(value) {\r\n      for (var i = 0; i < RDFaProcessor.dateTimeTypes.length; i++) {\r\n        // console.log(\"Checking \"+value+\" against \"+RDFaProcessor.dateTimeTypes[i].type)\r\n        var matched = RDFaProcessor.dateTimeTypes[i].pattern.exec(value);\r\n        if (matched && matched[0].length === value.length) {\r\n          // console.log(\"Matched!\")\r\n          return RDFaProcessor.dateTimeTypes[i].type;\r\n        }\r\n      }\r\n      return null;\r\n    }\r\n  }, {\r\n    key: 'init',\r\n    value: function init() {}\r\n  }, {\r\n    key: 'newBlankNode',\r\n    value: function newBlankNode() {\r\n      this.blankCounter++;\r\n      return '_:' + this.blankCounter;\r\n    }\r\n  }, {\r\n    key: 'newSubjectOrigin',\r\n    value: function newSubjectOrigin(origin, subject) {}\r\n  }, {\r\n    key: 'parseCURIE',\r\n    value: function parseCURIE(value, prefixes, base) {\r\n      var colon = value.indexOf(':');\r\n      var uri;\r\n      if (colon >= 0) {\r\n        var prefix = value.substring(0, colon);\r\n        if (prefix === '') {\r\n          // default prefix\r\n          uri = prefixes[''];\r\n          return uri ? uri + value.substring(colon + 1) : null;\r\n        } else if (prefix === '_') {\r\n          // blank node\r\n          return '_:' + value.substring(colon + 1);\r\n        } else if (RDFaProcessor.NCNAME.test(prefix)) {\r\n          uri = prefixes[prefix];\r\n          if (uri) {\r\n            return uri + value.substring(colon + 1);\r\n          }\r\n        }\r\n      }\r\n      return null;\r\n    }\r\n  }, {\r\n    key: 'parseCURIEOrURI',\r\n    value: function parseCURIEOrURI(value, prefixes, base) {\r\n      var curie = this.parseCURIE(value, prefixes, base);\r\n      if (curie) {\r\n        return curie;\r\n      }\r\n      return this.resolveAndNormalize(base, value);\r\n    }\r\n  }, {\r\n    key: 'parsePredicate',\r\n    value: function parsePredicate(value, defaultVocabulary, terms, prefixes, base, ignoreTerms) {\r\n      if (value === '') {\r\n        return null;\r\n      }\r\n      var predicate = this.parseTermOrCURIEOrAbsURI(value, defaultVocabulary, ignoreTerms ? null : terms, prefixes, base);\r\n      if (predicate && predicate.indexOf('_:') === 0) {\r\n        return null;\r\n      }\r\n      return predicate;\r\n    }\r\n  }, {\r\n    key: 'parsePrefixMappings',\r\n    value: function parsePrefixMappings(str, target) {\r\n      var values = this.tokenize(str);\r\n      var prefix = null;\r\n      // var uri = null\r\n      for (var i = 0; i < values.length; i++) {\r\n        if (values[i][values[i].length - 1] === ':') {\r\n          prefix = values[i].substring(0, values[i].length - 1);\r\n        } else if (prefix) {\r\n          target[prefix] = this.options.base ? Uri.join(values[i], this.options.base) : values[i];\r\n          prefix = null;\r\n        }\r\n      }\r\n    }\r\n  }, {\r\n    key: 'parseSafeCURIEOrCURIEOrURI',\r\n    value: function parseSafeCURIEOrCURIEOrURI(value, prefixes, base) {\r\n      value = this.trim(value);\r\n      if (value.charAt(0) === '[' && value.charAt(value.length - 1) === ']') {\r\n        value = value.substring(1, value.length - 1);\r\n        value = value.trim(value);\r\n        if (value.length === 0) {\r\n          return null;\r\n        }\r\n        if (value === '_:') {\r\n          // the one node\r\n          return this.theOne;\r\n        }\r\n        return this.parseCURIE(value, prefixes, base);\r\n      } else {\r\n        return this.parseCURIEOrURI(value, prefixes, base);\r\n      }\r\n    }\r\n  }, {\r\n    key: 'parseTermOrCURIEOrAbsURI',\r\n    value: function parseTermOrCURIEOrAbsURI(value, defaultVocabulary, terms, prefixes, base) {\r\n      // alert(\"Parsing \"+value+\" with default vocab \"+defaultVocabulary)\r\n      value = this.trim(value);\r\n      var curie = this.parseCURIE(value, prefixes, base);\r\n      if (curie) {\r\n        return curie;\r\n      } else if (terms) {\r\n        if (defaultVocabulary && !this.absURIRE.exec(value)) {\r\n          return defaultVocabulary + value;\r\n        }\r\n        var term = terms[value];\r\n        if (term) {\r\n          return term;\r\n        }\r\n        var lcvalue = value.toLowerCase();\r\n        term = terms[lcvalue];\r\n        if (term) {\r\n          return term;\r\n        }\r\n      }\r\n      if (this.absURIRE.exec(value)) {\r\n        return this.resolveAndNormalize(base, value);\r\n      }\r\n      return null;\r\n    }\r\n  }, {\r\n    key: 'parseTermOrCURIEOrURI',\r\n    value: function parseTermOrCURIEOrURI(value, defaultVocabulary, terms, prefixes, base) {\r\n      // alert(\"Parsing \"+value+\" with default vocab \"+defaultVocabulary)\r\n      value = this.trim(value);\r\n      var curie = this.parseCURIE(value, prefixes, base);\r\n      if (curie) {\r\n        return curie;\r\n      } else {\r\n        var term = terms[value];\r\n        if (term) {\r\n          return term;\r\n        }\r\n        var lcvalue = value.toLowerCase();\r\n        term = terms[lcvalue];\r\n        if (term) {\r\n          return term;\r\n        }\r\n        if (defaultVocabulary && !this.absURIRE.exec(value)) {\r\n          return defaultVocabulary + value;\r\n        }\r\n      }\r\n      return this.resolveAndNormalize(base, value);\r\n    }\r\n  }, {\r\n    key: 'parseURI',\r\n    value: function parseURI(uri) {\r\n      return uri; // We just use strings as URIs, not objects now.\r\n    }\r\n  }, {\r\n    key: 'process',\r\n    value: function process(node, options) {\r\n      /*\r\n      if (!window.console) {\r\n         window.console = { log: function() {} }\r\n      }*/\r\n      var base;\r\n      if (node.nodeType === Node.DOCUMENT_NODE) {\r\n        base = node.baseURI;\r\n        node = node.documentElement;\r\n        //node.baseURI = base;\r\n        this.setContext(node);\r\n      } else if (node.parentNode.nodeType === Node.DOCUMENT_NODE) {\r\n        this.setContext(node);\r\n      }\r\n      var queue = [];\r\n      // Fix for Firefox that includes the hash in the base URI\r\n      var removeHash = function removeHash(baseURI) {\r\n        // Fix for undefined baseURI property\r\n        if (!baseURI && options && options.baseURI) {\r\n          return options.baseURI;\r\n        }\r\n\r\n        var hash = baseURI.indexOf('#');\r\n        if (hash >= 0) {\r\n          baseURI = baseURI.substring(0, hash);\r\n        }\r\n        if (options && options.baseURIMap) {\r\n          baseURI = options.baseURIMap(baseURI);\r\n        }\r\n        return baseURI;\r\n      };\r\n      queue.push({ current: node,\r\n        context: this.push(null, removeHash(node.baseURI))\r\n      });\r\n      while (queue.length > 0) {\r\n        var item = queue.shift();\r\n        if (item.parent) {\r\n          // Sequence Step 14: list triple generation\r\n          if (item.context.parent && item.context.parent.listMapping === item.listMapping) {\r\n            // Skip a child context with exactly the same mapping\r\n            continue;\r\n          }\r\n          // console.log(\"Generating lists for \"+item.subject+\", tag \"+item.parent.localName)\r\n          for (var _predicate in item.listMapping) {\r\n            var list = item.listMapping[_predicate];\r\n            if (list.length === 0) {\r\n              this.addTriple(item.parent, item.subject, _predicate, { type: RDFaProcessor.objectURI, value: 'http://www.w3.org/1999/02/22-rdf-syntax-ns#nil' });\r\n              continue;\r\n            }\r\n            var bnodes = [];\r\n            for (var _i = 0; _i < list.length; _i++) {\r\n              bnodes.push(this.newBlankNode());\r\n              // this.newSubject(item.parent,bnodes[i])\r\n            }\r\n            for (var _i2 = 0; _i2 < bnodes.length; _i2++) {\r\n              this.addTriple(item.parent, bnodes[_i2], 'http://www.w3.org/1999/02/22-rdf-syntax-ns#first', list[_i2]);\r\n              this.addTriple(item.parent, bnodes[_i2], 'http://www.w3.org/1999/02/22-rdf-syntax-ns#rest', { type: RDFaProcessor.objectURI, value: _i2 + 1 < bnodes.length ? bnodes[_i2 + 1] : 'http://www.w3.org/1999/02/22-rdf-syntax-ns#nil' });\r\n            }\r\n            this.addTriple(item.parent, item.subject, _predicate, { type: RDFaProcessor.objectURI, value: bnodes[0] });\r\n          }\r\n          continue;\r\n        }\r\n        var current = item.current;\r\n        var context = item.context;\r\n        // console.log(\"Tag: \"+current.localName+\", listMapping=\"+JSON.stringify(context.listMapping))\r\n        // Sequence Step 1\r\n        var skip = false;\r\n        var newSubject = null;\r\n        var currentObjectResource = null;\r\n        var typedResource = null;\r\n        var prefixes = context.prefixes;\r\n        var prefixesCopied = false;\r\n        var incomplete = [];\r\n        var listMapping = context.listMapping;\r\n        var listMappingDifferent = !context.parent;\r\n        var language = context.language;\r\n        var vocabulary = context.vocabulary;\r\n        // TODO: the \"base\" element may be used for HTML+RDFa 1.1\r\n        base = this.parseURI(removeHash(current.baseURI));\r\n        current.item = null;\r\n        // Sequence Step 2: set the default vocabulary\r\n        var vocabAtt = current.getAttributeNode('vocab');\r\n        if (vocabAtt) {\r\n          var value = this.trim(vocabAtt.value);\r\n          if (value.length > 0) {\r\n            vocabulary = value;\r\n            var baseSubject = base.spec;\r\n            // this.newSubject(current,baseSubject)\r\n            this.addTriple(current, baseSubject, 'http://www.w3.org/ns/rdfa#usesVocabulary', { type: RDFaProcessor.objectURI, value: vocabulary });\r\n          } else {\r\n            vocabulary = this.vocabulary;\r\n          }\r\n        }\r\n        // Sequence Step 3: IRI mappings\r\n        // handle xmlns attributes\r\n        for (var i = 0; i < current.attributes.length; i++) {\r\n          var att = current.attributes[i];\r\n          // if (att.namespaceURI==\"http://www.w3.org/2000/xmlns/\") {\r\n          if (att.nodeName.charAt(0) === 'x' && att.nodeName.indexOf('xmlns:') === 0) {\r\n            if (!prefixesCopied) {\r\n              prefixes = this.copyMappings(prefixes);\r\n              prefixesCopied = true;\r\n            }\r\n            var prefix = att.nodeName.substring(6);\r\n            // TODO: resolve relative?\r\n            var ref = this.trim(att.value);\r\n            prefixes[prefix] = this.options.base ? Uri.join(ref, this.options.base) : ref;\r\n          }\r\n        }\r\n        // Handle prefix mappings (@prefix)\r\n        var prefixAtt = current.getAttributeNode('prefix');\r\n        if (prefixAtt) {\r\n          if (!prefixesCopied) {\r\n            prefixes = this.copyMappings(prefixes);\r\n            prefixesCopied = true;\r\n          }\r\n          this.parsePrefixMappings(prefixAtt.value, prefixes);\r\n        }\r\n        // Sequence Step 4: language\r\n        var xmlLangAtt = null;\r\n        for (var _i3 = 0; !xmlLangAtt && _i3 < this.langAttributes.length; _i3++) {\r\n          xmlLangAtt = current.getAttributeNodeNS(this.langAttributes[_i3].namespaceURI, this.langAttributes[_i3].localName);\r\n        }\r\n        if (xmlLangAtt) {\r\n          var _value = this.trim(xmlLangAtt.value);\r\n          if (_value.length > 0) {\r\n            language = _value;\r\n          } else {\r\n            language = null;\r\n          }\r\n        }\r\n        var relAtt = current.getAttributeNode('rel');\r\n        var revAtt = current.getAttributeNode('rev');\r\n        var typeofAtt = current.getAttributeNode('typeof');\r\n        var propertyAtt = current.getAttributeNode('property');\r\n        var datatypeAtt = current.getAttributeNode('datatype');\r\n        var datetimeAtt = this.inHTMLMode ? current.getAttributeNode('datetime') : null;\r\n        var contentAtt = current.getAttributeNode('content');\r\n        var aboutAtt = current.getAttributeNode('about');\r\n        var srcAtt = current.getAttributeNode('src');\r\n        var resourceAtt = current.getAttributeNode('resource');\r\n        var hrefAtt = current.getAttributeNode('href');\r\n        var inlistAtt = current.getAttributeNode('inlist');\r\n        var relAttPredicates = [];\r\n        var predicate, values;\r\n        if (relAtt) {\r\n          values = this.tokenize(relAtt.value);\r\n          for (var _i4 = 0; _i4 < values.length; _i4++) {\r\n            predicate = this.parsePredicate(values[_i4], vocabulary, context.terms, prefixes, base, this.inHTMLMode && propertyAtt !== null);\r\n            if (predicate) {\r\n              relAttPredicates.push(predicate);\r\n            }\r\n          }\r\n        }\r\n        var revAttPredicates = [];\r\n        if (revAtt) {\r\n          values = this.tokenize(revAtt.value);\r\n          for (var _i5 = 0; _i5 < values.length; _i5++) {\r\n            predicate = this.parsePredicate(values[_i5], vocabulary, context.terms, prefixes, base, this.inHTMLMode && propertyAtt);\r\n            if (predicate) {\r\n              revAttPredicates.push(predicate);\r\n            }\r\n          }\r\n        }\r\n        // Section 3.1, bullet 7\r\n        if (this.inHTMLMode && (relAtt || revAtt) && propertyAtt) {\r\n          if (relAttPredicates.length === 0) {\r\n            relAtt = null;\r\n          }\r\n          if (revAttPredicates.length === 0) {\r\n            revAtt = null;\r\n          }\r\n        }\r\n        if (relAtt || revAtt) {\r\n          // Sequence Step 6: establish new subject and value\r\n          if (aboutAtt) {\r\n            newSubject = this.parseSafeCURIEOrCURIEOrURI(aboutAtt.value, prefixes, base);\r\n          }\r\n          if (typeofAtt) {\r\n            typedResource = newSubject;\r\n          }\r\n          if (!newSubject) {\r\n            if (current.parentNode.nodeType === Node.DOCUMENT_NODE) {\r\n              newSubject = removeHash(current.baseURI);\r\n            } else if (context.parentObject) {\r\n              // TODO: Verify: If the xml:base has been set and the parentObject is the baseURI of the parent, then the subject needs to be the new base URI\r\n              newSubject = removeHash(current.parentNode.baseURI) === context.parentObject ? removeHash(current.baseURI) : context.parentObject;\r\n            }\r\n          }\r\n          if (resourceAtt) {\r\n            currentObjectResource = this.parseSafeCURIEOrCURIEOrURI(resourceAtt.value, prefixes, base);\r\n          }\r\n          if (!currentObjectResource) {\r\n            if (hrefAtt) {\r\n              currentObjectResource = this.resolveAndNormalize(base, encodeURI(hrefAtt.value));\r\n            } else if (srcAtt) {\r\n              currentObjectResource = this.resolveAndNormalize(base, encodeURI(srcAtt.value));\r\n            } else if (typeofAtt && !aboutAtt && !(this.inXHTMLMode && (current.localName === 'head' || current.localName === 'body'))) {\r\n              currentObjectResource = this.newBlankNode();\r\n            }\r\n          }\r\n          if (typeofAtt && !aboutAtt && this.inXHTMLMode && (current.localName === 'head' || current.localName === 'body')) {\r\n            typedResource = newSubject;\r\n          } else if (typeofAtt && !aboutAtt) {\r\n            typedResource = currentObjectResource;\r\n          }\r\n        } else if (propertyAtt && !contentAtt && !datatypeAtt) {\r\n          // Sequence Step 5.1: establish a new subject\r\n          if (aboutAtt) {\r\n            newSubject = this.parseSafeCURIEOrCURIEOrURI(aboutAtt.value, prefixes, base);\r\n            if (typeofAtt) {\r\n              typedResource = newSubject;\r\n            }\r\n          }\r\n          if (!newSubject && current.parentNode.nodeType === Node.DOCUMENT_NODE) {\r\n            newSubject = removeHash(current.baseURI);\r\n            if (typeofAtt) {\r\n              typedResource = newSubject;\r\n            }\r\n          } else if (!newSubject && context.parentObject) {\r\n            // TODO: Verify: If the xml:base has been set and the parentObject is the baseURI of the parent, then the subject needs to be the new base URI\r\n            newSubject = removeHash(current.parentNode.baseURI) === context.parentObject ? removeHash(current.baseURI) : context.parentObject;\r\n          }\r\n          if (typeofAtt && !typedResource) {\r\n            if (resourceAtt) {\r\n              typedResource = this.parseSafeCURIEOrCURIEOrURI(resourceAtt.value, prefixes, base);\r\n            }\r\n            if (!typedResource && hrefAtt) {\r\n              typedResource = this.resolveAndNormalize(base, encodeURI(hrefAtt.value));\r\n            }\r\n            if (!typedResource && srcAtt) {\r\n              typedResource = this.resolveAndNormalize(base, encodeURI(srcAtt.value));\r\n            }\r\n            if (!typedResource && (this.inXHTMLMode || this.inHTMLMode) && (current.localName === 'head' || current.localName === 'body')) {\r\n              typedResource = newSubject;\r\n            }\r\n            if (!typedResource) {\r\n              typedResource = this.newBlankNode();\r\n            }\r\n            currentObjectResource = typedResource;\r\n          }\r\n          // console.log(current.localName+\", newSubject=\"+newSubject+\", typedResource=\"+typedResource+\", currentObjectResource=\"+currentObjectResource)\r\n        } else {\r\n          // Sequence Step 5.2: establish a new subject\r\n          if (aboutAtt) {\r\n            newSubject = this.parseSafeCURIEOrCURIEOrURI(aboutAtt.value, prefixes, base);\r\n          }\r\n          if (!newSubject && resourceAtt) {\r\n            newSubject = this.parseSafeCURIEOrCURIEOrURI(resourceAtt.value, prefixes, base);\r\n          }\r\n          if (!newSubject && hrefAtt) {\r\n            newSubject = this.resolveAndNormalize(base, encodeURI(hrefAtt.value));\r\n          }\r\n          if (!newSubject && srcAtt) {\r\n            newSubject = this.resolveAndNormalize(base, encodeURI(srcAtt.value));\r\n          }\r\n          if (!newSubject) {\r\n            if (current.parentNode.nodeType === Node.DOCUMENT_NODE) {\r\n              newSubject = removeHash(current.baseURI);\r\n            } else if ((this.inXHTMLMode || this.inHTMLMode) && (current.localName === 'head' || current.localName === 'body')) {\r\n              newSubject = removeHash(current.parentNode.baseURI) === context.parentObject ? removeHash(current.baseURI) : context.parentObject;\r\n            } else if (typeofAtt) {\r\n              newSubject = this.newBlankNode();\r\n            } else if (context.parentObject) {\r\n              // TODO: Verify: If the xml:base has been set and the parentObject is the baseURI of the parent, then the subject needs to be the new base URI\r\n              newSubject = removeHash(current.parentNode.baseURI) === context.parentObject ? removeHash(current.baseURI) : context.parentObject;\r\n              if (!propertyAtt) {\r\n                skip = true;\r\n              }\r\n            }\r\n          }\r\n          if (typeofAtt) {\r\n            typedResource = newSubject;\r\n          }\r\n        }\r\n        // console.log(current.tagName+\": newSubject=\"+newSubject+\", currentObjectResource=\"+currentObjectResource+\", typedResource=\"+typedResource+\", skip=\"+skip)\r\n        // var rdfaData = null\r\n        if (newSubject) {\r\n          // this.newSubject(current,newSubject)\r\n          if (aboutAtt || resourceAtt || typedResource) {\r\n            var id = newSubject;\r\n            if (typeofAtt && !aboutAtt && !resourceAtt && currentObjectResource) {\r\n              id = currentObjectResource;\r\n            }\r\n            // console.log(\"Setting data attribute for \"+current.localName+\" for subject \"+id)\r\n            this.newSubjectOrigin(current, id);\r\n          }\r\n        }\r\n        // Sequence Step 7: generate type triple\r\n        if (typedResource) {\r\n          values = this.tokenize(typeofAtt.value);\r\n          for (var _i6 = 0; _i6 < values.length; _i6++) {\r\n            var object = this.parseTermOrCURIEOrAbsURI(values[_i6], vocabulary, context.terms, prefixes, base);\r\n            if (object) {\r\n              this.addTriple(current, typedResource, RDFaProcessor.typeURI, { type: RDFaProcessor.objectURI, value: object });\r\n            }\r\n          }\r\n        }\r\n        // Sequence Step 8: new list mappings if there is a new subject\r\n        // console.log(\"Step 8: newSubject=\"+newSubject+\", context.parentObject=\"+context.parentObject)\r\n        if (newSubject && newSubject !== context.parentObject) {\r\n          // console.log(\"Generating new list mapping for \"+newSubject)\r\n          listMapping = {};\r\n          listMappingDifferent = true;\r\n        }\r\n        // Sequence Step 9: generate object triple\r\n        if (currentObjectResource) {\r\n          if (relAtt && inlistAtt) {\r\n            for (var _i7 = 0; _i7 < relAttPredicates.length; _i7++) {\r\n              var _list = listMapping[relAttPredicates[_i7]];\r\n              if (!_list) {\r\n                _list = [];\r\n                listMapping[relAttPredicates[_i7]] = _list;\r\n              }\r\n              _list.push({ type: RDFaProcessor.objectURI, value: currentObjectResource });\r\n            }\r\n          } else if (relAtt) {\r\n            for (var _i8 = 0; _i8 < relAttPredicates.length; _i8++) {\r\n              this.addTriple(current, newSubject, relAttPredicates[_i8], { type: RDFaProcessor.objectURI, value: currentObjectResource });\r\n            }\r\n          }\r\n          if (revAtt) {\r\n            for (var _i9 = 0; _i9 < revAttPredicates.length; _i9++) {\r\n              this.addTriple(current, currentObjectResource, revAttPredicates[_i9], { type: RDFaProcessor.objectURI, value: newSubject });\r\n            }\r\n          }\r\n        } else {\r\n          // Sequence Step 10: incomplete triples\r\n          if (newSubject && !currentObjectResource && (relAtt || revAtt)) {\r\n            currentObjectResource = this.newBlankNode();\r\n            // alert(current.tagName+\": generated blank node, newSubject=\"+newSubject+\" currentObjectResource=\"+currentObjectResource)\r\n          }\r\n          if (relAtt && inlistAtt) {\r\n            for (var _i10 = 0; _i10 < relAttPredicates.length; _i10++) {\r\n              var _list2 = listMapping[relAttPredicates[_i10]];\r\n              if (!_list2) {\r\n                _list2 = [];\r\n                listMapping[predicate] = _list2;\r\n              }\r\n              // console.log(\"Adding incomplete list for \"+predicate)\r\n              incomplete.push({ predicate: relAttPredicates[_i10], list: _list2 });\r\n            }\r\n          } else if (relAtt) {\r\n            for (var _i11 = 0; _i11 < relAttPredicates.length; _i11++) {\r\n              incomplete.push({ predicate: relAttPredicates[_i11], forward: true });\r\n            }\r\n          }\r\n          if (revAtt) {\r\n            for (var _i12 = 0; _i12 < revAttPredicates.length; _i12++) {\r\n              incomplete.push({ predicate: revAttPredicates[_i12], forward: false });\r\n            }\r\n          }\r\n        }\r\n        // Step 11: Current property values\r\n        if (propertyAtt) {\r\n          var datatype = null;\r\n          var content = null;\r\n          if (datatypeAtt) {\r\n            datatype = datatypeAtt.value === '' ? RDFaProcessor.PlainLiteralURI : this.parseTermOrCURIEOrAbsURI(datatypeAtt.value, vocabulary, context.terms, prefixes, base);\r\n            if (datetimeAtt && !contentAtt) {\r\n              content = datetimeAtt.value;\r\n            } else {\r\n              content = datatype === RDFaProcessor.XMLLiteralURI || datatype === RDFaProcessor.HTMLLiteralURI ? null : contentAtt ? contentAtt.value : current.textContent;\r\n            }\r\n          } else if (contentAtt) {\r\n            datatype = RDFaProcessor.PlainLiteralURI;\r\n            content = contentAtt.value;\r\n          } else if (datetimeAtt) {\r\n            content = datetimeAtt.value;\r\n            datatype = RDFaProcessor.deriveDateTimeType(content);\r\n            if (!datatype) {\r\n              datatype = RDFaProcessor.PlainLiteralURI;\r\n            }\r\n          } else if (!relAtt && !revAtt) {\r\n            if (resourceAtt) {\r\n              content = this.parseSafeCURIEOrCURIEOrURI(resourceAtt.value, prefixes, base);\r\n            }\r\n            if (!content && hrefAtt) {\r\n              content = this.resolveAndNormalize(base, encodeURI(hrefAtt.value));\r\n            } else if (!content && srcAtt) {\r\n              content = this.resolveAndNormalize(base, encodeURI(srcAtt.value));\r\n            }\r\n            if (content) {\r\n              datatype = RDFaProcessor.objectURI;\r\n            }\r\n          }\r\n          if (!datatype) {\r\n            if (typeofAtt && !aboutAtt) {\r\n              datatype = RDFaProcessor.objectURI;\r\n              content = typedResource;\r\n            } else {\r\n              content = current.textContent;\r\n              if (this.inHTMLMode && current.localName === 'time') {\r\n                datatype = RDFaProcessor.deriveDateTimeType(content);\r\n              }\r\n              if (!datatype) {\r\n                datatype = RDFaProcessor.PlainLiteralURI;\r\n              }\r\n            }\r\n          }\r\n          values = this.tokenize(propertyAtt.value);\r\n          for (var _i13 = 0; _i13 < values.length; _i13++) {\r\n            var _predicate2 = this.parsePredicate(values[_i13], vocabulary, context.terms, prefixes, base);\r\n            if (_predicate2) {\r\n              if (inlistAtt) {\r\n                var _list3 = listMapping[_predicate2];\r\n                if (!_list3) {\r\n                  _list3 = [];\r\n                  listMapping[_predicate2] = _list3;\r\n                }\r\n                _list3.push(datatype === RDFaProcessor.XMLLiteralURI || datatype === RDFaProcessor.HTMLLiteralURI ? { type: datatype, value: current.childNodes } : { type: datatype ? datatype : RDFaProcessor.PlainLiteralURI, value: content, language: language });\r\n              } else {\r\n                if (datatype === RDFaProcessor.XMLLiteralURI || datatype === RDFaProcessor.HTMLLiteralURI) {\r\n                  this.addTriple(current, newSubject, _predicate2, { type: datatype, value: current.childNodes });\r\n                } else {\r\n                  this.addTriple(current, newSubject, _predicate2, { type: datatype ? datatype : RDFaProcessor.PlainLiteralURI, value: content, language: language });\r\n                  // console.log(newSubject+\" \"+predicate+\"=\"+content)\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n        // Sequence Step 12: complete incomplete triples with new subject\r\n        if (newSubject && !skip) {\r\n          for (var _i14 = 0; _i14 < context.incomplete.length; _i14++) {\r\n            if (context.incomplete[_i14].list) {\r\n              // console.log(\"Adding subject \"+newSubject+\" to list for \"+context.incomplete[i].predicate)\r\n              // TODO: it is unclear what to do here\r\n              context.incomplete[_i14].list.push({ type: RDFaProcessor.objectURI, value: newSubject });\r\n            } else if (context.incomplete[_i14].forward) {\r\n              // console.log(current.tagName+\": completing forward triple \"+context.incomplete[i].predicate+\" with object=\"+newSubject)\r\n              this.addTriple(current, context.subject, context.incomplete[_i14].predicate, { type: RDFaProcessor.objectURI, value: newSubject });\r\n            } else {\r\n              // console.log(current.tagName+\": completing reverse triple with object=\"+context.subject)\r\n              this.addTriple(current, newSubject, context.incomplete[_i14].predicate, { type: RDFaProcessor.objectURI, value: context.subject });\r\n            }\r\n          }\r\n        }\r\n        var childContext = null;\r\n        var listSubject = newSubject;\r\n        if (skip) {\r\n          // TODO: should subject be null?\r\n          childContext = this.push(context, context.subject);\r\n          // TODO: should the entObject be passed along?  If not, then intermediary children will keep properties from being associated with incomplete triples.\r\n          // TODO: Verify: if the current baseURI has changed and the parentObject is the parent's base URI, then the baseURI should change\r\n          childContext.parentObject = removeHash(current.parentNode.baseURI) === context.parentObject ? removeHash(current.baseURI) : context.parentObject;\r\n          childContext.incomplete = context.incomplete;\r\n          childContext.language = language;\r\n          childContext.prefixes = prefixes;\r\n          childContext.vocabulary = vocabulary;\r\n        } else {\r\n          childContext = this.push(context, newSubject);\r\n          childContext.parentObject = currentObjectResource ? currentObjectResource : newSubject ? newSubject : context.subject;\r\n          childContext.prefixes = prefixes;\r\n          childContext.incomplete = incomplete;\r\n          if (currentObjectResource) {\r\n            // console.log(\"Generating new list mapping for \"+currentObjectResource)\r\n            listSubject = currentObjectResource;\r\n            listMapping = {};\r\n            listMappingDifferent = true;\r\n          }\r\n          childContext.listMapping = listMapping;\r\n          childContext.language = language;\r\n          childContext.vocabulary = vocabulary;\r\n        }\r\n        if (listMappingDifferent) {\r\n          // console.log(\"Pushing list parent \"+current.localName)\r\n          queue.unshift({ parent: current, context: context, subject: listSubject, listMapping: listMapping });\r\n        }\r\n        for (var child = current.lastChild; child; child = child.previousSibling) {\r\n          if (child.nodeType === Node.ELEMENT_NODE) {\r\n            // console.log(\"Pushing child \"+child.localName)\r\n            //child.baseURI = current.baseURI;\r\n            queue.unshift({ current: child, context: childContext });\r\n          }\r\n        }\r\n      }\r\n      if (this.inHTMLMode) {\r\n        this.copyProperties();\r\n      }\r\n      for (var _i15 = 0; _i15 < this.finishedHandlers.length; _i15++) {\r\n        this.finishedHandlers[_i15](node);\r\n      }\r\n    }\r\n  }, {\r\n    key: 'push',\r\n    value: function push(parent, subject) {\r\n      return {\r\n        parent: parent,\r\n        subject: subject ? subject : parent ? parent.subject : null,\r\n        parentObject: null,\r\n        incomplete: [],\r\n        listMapping: parent ? parent.listMapping : {},\r\n        language: parent ? parent.language : this.language,\r\n        prefixes: parent ? parent.prefixes : this.target.graph.prefixes,\r\n        terms: parent ? parent.terms : this.target.graph.terms,\r\n        vocabulary: parent ? parent.vocabulary : this.vocabulary\r\n      };\r\n    }\r\n  }, {\r\n    key: 'resolveAndNormalize',\r\n    value: function resolveAndNormalize(base, uri) {\r\n      // console.log(\"Joining \" + uri + \" to \" + base + \" making \" +  Uri.join(uri, base))\r\n      return Uri.join(uri, base); // @@ normalize?\r\n    }\r\n  }, {\r\n    key: 'setContext',\r\n    value: function setContext(node) {\r\n      // We only recognized XHTML+RDFa 1.1 if the version is set propertyly\r\n      if (node.localName === 'html' && node.getAttribute('version') === 'XHTML+RDFa 1.1') {\r\n        this.setXHTMLContext();\r\n      } else if (node.localName === 'html' || node.namespaceURI === 'http://www.w3.org/1999/xhtml') {\r\n        if (typeof document !== 'undefined' && document.doctype) {\r\n          if (document.doctype.publicId === '-//W3C//DTD XHTML+RDFa 1.0//EN' && document.doctype.systemId === 'http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd') {\r\n            console.log('WARNING: RDF 1.0 is not supported.  Defaulting to HTML5 mode.');\r\n            this.setHTMLContext();\r\n          } else if (document.doctype.publicId === '-//W3C//DTD XHTML+RDFa 1.1//EN' && document.doctype.systemId === 'http://www.w3.org/MarkUp/DTD/xhtml-rdfa-2.dtd') {\r\n            this.setXHTMLContext();\r\n          } else {\r\n            this.setHTMLContext();\r\n          }\r\n        } else {\r\n          this.setHTMLContext();\r\n        }\r\n      } else {\r\n        this.setXMLContext();\r\n      }\r\n    }\r\n  }, {\r\n    key: 'setHTMLContext',\r\n    value: function setHTMLContext() {\r\n      this.setInitialContext();\r\n      this.langAttributes = [{\r\n        namespaceURI: 'http://www.w3.org/XML/1998/namespace',\r\n        localName: 'lang'\r\n      }, { namespaceURI: null, localName: 'lang' }];\r\n      this.inXHTMLMode = false;\r\n      this.inHTMLMode = true;\r\n    }\r\n  }, {\r\n    key: 'setInitialContext',\r\n    value: function setInitialContext() {\r\n      this.vocabulary = null;\r\n      // By default, the prefixes are terms are loaded to the RDFa 1.1. standard within the graph constructor\r\n      this.langAttributes = [{\r\n        namespaceURI: 'http://www.w3.org/XML/1998/namespace',\r\n        localName: 'lang'\r\n      }];\r\n    }\r\n  }, {\r\n    key: 'setXHTMLContext',\r\n    value: function setXHTMLContext() {\r\n      this.setInitialContext();\r\n      this.inXHTMLMode = true;\r\n      this.inHTMLMode = false;\r\n      this.langAttributes = [{\r\n        namespaceURI: 'http://www.w3.org/XML/1998/namespace',\r\n        localName: 'lang' }, { namespaceURI: null, localName: 'lang' }];\r\n      // From http://www.w3.org/2011/rdfa-context/xhtml-rdfa-1.1\r\n      this.target.graph.terms['alternate'] = 'http://www.w3.org/1999/xhtml/vocab#alternate';\r\n      this.target.graph.terms['appendix'] = 'http://www.w3.org/1999/xhtml/vocab#appendix';\r\n      this.target.graph.terms['bookmark'] = 'http://www.w3.org/1999/xhtml/vocab#bookmark';\r\n      this.target.graph.terms['cite'] = 'http://www.w3.org/1999/xhtml/vocab#cite';\r\n      this.target.graph.terms['chapter'] = 'http://www.w3.org/1999/xhtml/vocab#chapter';\r\n      this.target.graph.terms['contents'] = 'http://www.w3.org/1999/xhtml/vocab#contents';\r\n      this.target.graph.terms['copyright'] = 'http://www.w3.org/1999/xhtml/vocab#copyright';\r\n      this.target.graph.terms['first'] = 'http://www.w3.org/1999/xhtml/vocab#first';\r\n      this.target.graph.terms['glossary'] = 'http://www.w3.org/1999/xhtml/vocab#glossary';\r\n      this.target.graph.terms['help'] = 'http://www.w3.org/1999/xhtml/vocab#help';\r\n      this.target.graph.terms['icon'] = 'http://www.w3.org/1999/xhtml/vocab#icon';\r\n      this.target.graph.terms['index'] = 'http://www.w3.org/1999/xhtml/vocab#index';\r\n      this.target.graph.terms['last'] = 'http://www.w3.org/1999/xhtml/vocab#last';\r\n      this.target.graph.terms['license'] = 'http://www.w3.org/1999/xhtml/vocab#license';\r\n      this.target.graph.terms['meta'] = 'http://www.w3.org/1999/xhtml/vocab#meta';\r\n      this.target.graph.terms['next'] = 'http://www.w3.org/1999/xhtml/vocab#next';\r\n      this.target.graph.terms['prev'] = 'http://www.w3.org/1999/xhtml/vocab#prev';\r\n      this.target.graph.terms['previous'] = 'http://www.w3.org/1999/xhtml/vocab#previous';\r\n      this.target.graph.terms['section'] = 'http://www.w3.org/1999/xhtml/vocab#section';\r\n      this.target.graph.terms['stylesheet'] = 'http://www.w3.org/1999/xhtml/vocab#stylesheet';\r\n      this.target.graph.terms['subsection'] = 'http://www.w3.org/1999/xhtml/vocab#subsection';\r\n      this.target.graph.terms['start'] = 'http://www.w3.org/1999/xhtml/vocab#start';\r\n      this.target.graph.terms['top'] = 'http://www.w3.org/1999/xhtml/vocab#top';\r\n      this.target.graph.terms['up'] = 'http://www.w3.org/1999/xhtml/vocab#up';\r\n      this.target.graph.terms['p3pv1'] = 'http://www.w3.org/1999/xhtml/vocab#p3pv1';\r\n      // other\r\n      this.target.graph.terms['related'] = 'http://www.w3.org/1999/xhtml/vocab#related';\r\n      this.target.graph.terms['role'] = 'http://www.w3.org/1999/xhtml/vocab#role';\r\n      this.target.graph.terms['transformation'] = 'http://www.w3.org/1999/xhtml/vocab#transformation';\r\n    }\r\n  }, {\r\n    key: 'setXMLContext',\r\n    value: function setXMLContext() {\r\n      this.setInitialContext();\r\n      this.inXHTMLMode = false;\r\n      this.inHTMLMode = false;\r\n    }\r\n  }, {\r\n    key: 'tokenize',\r\n    value: function tokenize(str) {\r\n      return this.trim(str).split(/\\s+/);\r\n    }\r\n  }, {\r\n    key: 'toRDFNodeObject',\r\n    value: function toRDFNodeObject(x) {\r\n      if (typeof x === 'undefined') return undefined;\r\n      if (typeof x === 'string') {\r\n        if (x.substring(0, 2) === '_:') {\r\n          if (typeof this.blankNodes[x.substring(2)] === 'undefined') {\r\n            this.blankNodes[x.substring(2)] = new BlankNode(x.substring(2));\r\n          }\r\n          return this.blankNodes[x.substring(2)];\r\n        }\r\n        return rdf.namedNode(x);\r\n      }\r\n      switch (x.type) {\r\n        case RDFaProcessor.objectURI:\r\n          if (x.value.substring(0, 2) === '_:') {\r\n            if (typeof this.blankNodes[x.value.substring(2)] === 'undefined') {\r\n              this.blankNodes[x.value.substring(2)] = new BlankNode(x.value.substring(2));\r\n            }\r\n            return this.blankNodes[x.value.substring(2)];\r\n          }\r\n          return rdf.namedNode(x.value);\r\n        case RDFaProcessor.PlainLiteralURI:\r\n          return new Literal(x.value, x.language || '');\r\n        case RDFaProcessor.XMLLiteralURI:\r\n        case RDFaProcessor.HTMLLiteralURI:\r\n          var string = '';\r\n          Object.keys(x.value).forEach(function (i) {\r\n            string += Util.domToString(x.value[i], this.htmlOptions);\r\n          });\r\n          return new Literal(string, '', new NamedNode(x.type));\r\n        default:\r\n          return new Literal(x.value, '', new NamedNode(x.type));\r\n      }\r\n    }\r\n  }, {\r\n    key: 'trim',\r\n    value: function trim(str) {\r\n      return str.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\r\n    }\r\n  }], [{\r\n    key: 'parseRDFaDOM',\r\n    value: function parseRDFaDOM(dom, kb, base) {\r\n      var p = new RDFaProcessor(kb, { 'base': base });\r\n      //dom.baseURI = base;\r\n      p.process(dom);\r\n    }\r\n  }]);\r\n\r\n  return RDFaProcessor;\r\n}();\r\n\r\nRDFaProcessor.XMLLiteralURI = 'http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral';\r\nRDFaProcessor.HTMLLiteralURI = 'http://www.w3.org/1999/02/22-rdf-syntax-ns#HTML';\r\nRDFaProcessor.PlainLiteralURI = 'http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral';\r\nRDFaProcessor.objectURI = 'http://www.w3.org/1999/02/22-rdf-syntax-ns#object';\r\nRDFaProcessor.typeURI = 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type';\r\nRDFaProcessor.nameChar = '[-A-Z_a-z\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\u10000-\\uEFFFF.0-9\\xB7\\u0300-\\u036F\\u203F-\\u2040]';\r\nRDFaProcessor.nameStartChar = '[A-Za-z\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u0131\\u0134-\\u013E\\u0141-\\u0148\\u014A-\\u017E\\u0180-\\u01C3\\u01CD-\\u01F0\\u01F4-\\u01F5\\u01FA-\\u0217\\u0250-\\u02A8\\u02BB-\\u02C1\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03CE\\u03D0-\\u03D6\\u03DA\\u03DC\\u03DE\\u03E0\\u03E2-\\u03F3\\u0401-\\u040C\\u040E-\\u044F\\u0451-\\u045C\\u045E-\\u0481\\u0490-\\u04C4\\u04C7-\\u04C8\\u04CB-\\u04CC\\u04D0-\\u04EB\\u04EE-\\u04F5\\u04F8-\\u04F9\\u0531-\\u0556\\u0559\\u0561-\\u0586\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0621-\\u063A\\u0641-\\u064A\\u0671-\\u06B7\\u06BA-\\u06BE\\u06C0-\\u06CE\\u06D0-\\u06D3\\u06D5\\u06E5-\\u06E6\\u0905-\\u0939\\u093D\\u0958-\\u0961\\u0985-\\u098C\\u098F-\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09DC-\\u09DD\\u09DF-\\u09E1\\u09F0-\\u09F1\\u0A05-\\u0A0A\\u0A0F-\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32-\\u0A33\\u0A35-\\u0A36\\u0A38-\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8B\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2-\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AE0\\u0B05-\\u0B0C\\u0B0F-\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32-\\u0B33\\u0B36-\\u0B39\\u0B3D\\u0B5C-\\u0B5D\\u0B5F-\\u0B61\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99-\\u0B9A\\u0B9C\\u0B9E-\\u0B9F\\u0BA3-\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB5\\u0BB7-\\u0BB9\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C60-\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CDE\\u0CE0-\\u0CE1\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D28\\u0D2A-\\u0D39\\u0D60-\\u0D61\\u0E01-\\u0E2E\\u0E30\\u0E32-\\u0E33\\u0E40-\\u0E45\\u0E81-\\u0E82\\u0E84\\u0E87-\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA-\\u0EAB\\u0EAD-\\u0EAE\\u0EB0\\u0EB2-\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0F40-\\u0F47\\u0F49-\\u0F69\\u10A0-\\u10C5\\u10D0-\\u10F6\\u1100\\u1102-\\u1103\\u1105-\\u1107\\u1109\\u110B-\\u110C\\u110E-\\u1112\\u113C\\u113E\\u1140\\u114C\\u114E\\u1150\\u1154-\\u1155\\u1159\\u115F-\\u1161\\u1163\\u1165\\u1167\\u1169\\u116D-\\u116E\\u1172-\\u1173\\u1175\\u119E\\u11A8\\u11AB\\u11AE-\\u11AF\\u11B7-\\u11B8\\u11BA\\u11BC-\\u11C2\\u11EB\\u11F0\\u11F9\\u1E00-\\u1E9B\\u1EA0-\\u1EF9\\u1F00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2126\\u212A-\\u212B\\u212E\\u2180-\\u2182\\u3041-\\u3094\\u30A1-\\u30FA\\u3105-\\u312C\\uAC00-\\uD7A3\\u4E00-\\u9FA5\\u3007\\u3021-\\u3029_]';\r\nRDFaProcessor.NCNAME = new RegExp('^' + RDFaProcessor.nameStartChar + RDFaProcessor.nameChar + '*$');\r\n\r\n/*\r\nRDFaProcessor.prototype.resolveAndNormalize = function(base,href) {\r\n   var u = base.resolve(href)\r\n   var parsed = this.parseURI(u)\r\n   parsed.normalize()\r\n   return parsed.spec\r\n}\r\n*/\r\n\r\nRDFaProcessor.dateTimeTypes = [{ pattern: /-?P(?:[0-9]+Y)?(?:[0-9]+M)?(?:[0-9]+D)?(?:T(?:[0-9]+H)?(?:[0-9]+M)?(?:[0-9]+(?:\\.[0-9]+)?S)?)?/,\r\n  type: 'http://www.w3.org/2001/XMLSchema#duration' }, { pattern: /-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9]T(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\\.[0-9]+)?(?:Z|[+\\-][0-9][0-9]:[0-9][0-9])?/,\r\n  type: 'http://www.w3.org/2001/XMLSchema#dateTime' }, { pattern: /-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9](?:Z|[+\\-][0-9][0-9]:[0-9][0-9])?/,\r\n  type: 'http://www.w3.org/2001/XMLSchema#date' }, { pattern: /(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\\.[0-9]+)?(?:Z|[+\\-][0-9][0-9]:[0-9][0-9])?/,\r\n  type: 'http://www.w3.org/2001/XMLSchema#time' }, { pattern: /-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]/,\r\n  type: 'http://www.w3.org/2001/XMLSchema#gYearMonth' }, { pattern: /-?[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9]/,\r\n  type: 'http://www.w3.org/2001/XMLSchema#gYear' }];\r\n\r\nmodule.exports = RDFaProcessor;","module.exports = fetch;","var $rdf = require(\"rdflib\");\nvar fetch = require(\"node-fetch\");\nvar RDFaProcessor = require(\"./rdfa-processor-dirty-hack\");\n\n/**\n * Node Status:\n * \n * Locally undetermined: There are multiple local nodes satisfying the criteria specified for this object \n * Blank: The object represents a blank node in a graph that is locally available\n * Unresolved: This node is identified by a URI that has not yet been derefernced\n * \n * @type type\n */\n\nlet Headers = ((h) => h ? h : window.Headers)(fetch.Headers);\n\nfunction GraphNode() {\n    return new GraphNode.Impl(...arguments);\n}\n\nGraphNode.Impl = class {\n        \n        constructor(nodes, graph, sources) {\n            this._graph = graph;\n            if (Array.isArray(nodes)) {\n                this.nodes = nodes;\n                /*if (this.nodes.length === 0) {\n                    throw \"Can't represent empty set of nodes\";\n                }*/\n            } else {\n                this.nodes = [nodes];\n            }\n            this.sources = sources;\n        }\n        \n        get graph() {\n            if (!this._graph) {\n                throw Error(\"Operation not possible as no Graph is available, try fetching first\");\n            }\n            return this._graph;\n        }\n        \n        get node() {\n            if (this.nodes.length !== 1) {\n                throw Error(\"Operation not possible as this GraphNode is underdetermined\");\n            }\n            return this.nodes[0];\n        }\n        \n        get termType() {\n            return this.node.termType;\n        }\n        \n        get value() {;\n            return this.node.value;\n        }\n        \n        fetch() {\n            if ((this.termType !== \"NamedNode\") || \n                        (this.sources && this.sources.indexOf(this.value.split(\"#\")[0]) > -1)) {\n                return Promise.resolve(this);\n            } else {\n                //TODO extend existing graph?\n                var uri = this.value.split(\"#\")[0];\n                return GraphNode.rdfFetch(uri).then(response => response.graph()).then(graph => GraphNode(this.node, graph, [uri]));\n            }\n        }\n        \n        /*\n         * \n         * @param {type} f\n         * @returns {unresolved} a promise that is satisfied when all promises returned by f are resolved\n         */\n        each(f) {\n            var results = this.nodes.map(node => f(GraphNode([node], this.graph, this.sources)));\n            return Promise.all(results);\n        }\n        \n        fetchEach(f) {\n            var results = this.nodes.map(node => GraphNode([node], this.graph, this.sources).fetch().then(f));\n            return Promise.all(results);\n        }\n\n        /**\n         * Returns a GraphNode for each node represented by this GraphNode\n         */\n        split() {\n            return this.nodes.map(node => GraphNode([node], this.graph, this.sources));\n        }\n        \n        out(predicate) {\n            var nodes = this.graph.each(this.node, predicate);\n            /*if (nodes.length === 0) {\n                throw \"No property \"+predicate+\" on \"+this.node;\n            }*/\n            return GraphNode(nodes, this.graph, this.sources);\n        }\n        \n        in(predicate) {\n            var statements = this.graph.statementsMatching(undefined, predicate, this.node);\n            /*if (statements.length === 0) {\n                throw \"No property \"+predicate+\" pointing to \"+this.node;\n            }*/\n            return GraphNode(statements.map(statement => statement.subject), this.graph, this.sources);\n        }\n    }\n\n/**\n * \n * Fetches an RDF graph. If the server return 401 the login process will be \n * started upon which the fetch will be retried.\n *\n * @param uri {string} The URI to be fetched\n * @param options passed to $rdf.Fetcher\n * @param login {boolean} The login function to be called, optional\n *\n * @return {Promise<Response>} Response has a `graph`property with the rertived graph\n */\nGraphNode.rdfFetch = function(uri, options, login) {\n    function plainFetch(uri, init = {}) {\n        if (!init.headers) {\n            init.headers = new Headers();\n        }\n        if (!init.headers.get(\"Accept\")) {\n            init.headers.set(\"Accept\", \"text/turtle;q=1, application/n-triples;q=.9, \"+\n                \"application/rdf+xml;q=.8, application/ld+json;q=.7, */*;q=.1\");\n        }\n        return fetch(uri, init).then(response => {\n            if (response.ok) {\n                response.graph = () => new Promise((resolve, reject) => {\n                    let graph = $rdf.graph();\n                    let mediaType = response.headers.get(\"Content-type\").split(\";\")[0];\n                    return response.text().then(text => {\n                        if ((mediaType === \"text/html\")  && (typeof DOMParser !== 'undefined')) {\n                            console.log(\"Working around rdflib problem parsing RDFa in browser\");\n                            try {\n                                RDFaProcessor.parseRDFaDOM($rdf.Util.parseXML(text, { contentType: mediaType }), graph, uri);\n                            } catch(error) {\n                                reject(error);\n                                return;\n                            }\n                            resolve(graph);\n                        } else {\n                            $rdf.parse(text, graph, uri, mediaType, (error, graph) => {\n                                if (error) {\n                                    reject(error);\n                                } else {\n                                    resolve(graph);\n                                }\n                            });\n                        }\n                    });\n                });\n                return response;\n            } else {\n                return response;\n            }\n        });\n    };\n    var ggg = this;\n    return plainFetch(uri, options).then(function (response) {\n        if (response.status < 300) {\n            return response;\n        } else {\n            if (login && response.status === 401) {\n                console.log(\"Got 401 response, attempting to login\");\n                return login().then(function () {\n                    return ggg.rdfFetch(uri, options);\n                });\n            } else {\n                return response;\n            }\n        }\n    });\n};\n\nmodule.exports = GraphNode;\n","var rdf = require(\"rdflib\");\nvar GraphNode = require(\"rdfgraphnode\");\nvar Mustache = require(\"mustache\");\nvar vocab = require(\"./vocab.js\");\nvar NodeSet = new Array();\n\n\nfunction RDF2h(rendererGraph, tbox) {\n    function r2h(suffix) {\n        return rdf.sym(\"http://rdf2h.github.io/2015/rdf2h#\"+suffix);\n    }\n    this.rendererGraph = rendererGraph;\n    if (tbox) {\n        this.tbox = tbox;\n    } else {\n        this.tbox = rendererGraph;\n    }\n    this.env = {}; //this is to allow shared vars among renderers\n}\n\n\n(function () {\n    var r2h = vocab.rdf2h;\n    var origLokup = Mustache.Context.prototype.lookup;\n    Mustache.Context.prototype.lookup = function (name) {\n        if (this.view instanceof RDF2h.Renderee) {\n            var rdf2h = this.view.rdf2h;\n            var graphNode = this.view.graphNode;\n            var graph = graphNode.graph;\n            var context = this.view.context;\n            function resolvePath(path) {\n                function resolveSubPath(node, pathSections) {\n                    function resolveSection(section) {\n                        if (section === \".\") {\n                            return node;\n                        } else {\n                            if (section.endsWith(\"<-\")) {\n                                return node.in(RDF2h.resolveCurie(section.substring(0, section.length - 2)));\n                            } else {\n                                if (section.startsWith(\"^\")) {\n                                    return node.in(RDF2h.resolveCurie(section.substring(1)));\n                                } else {\n                                    return node.out(RDF2h.resolveCurie(section));\n                                }\n                            }\n                        }\n                    }\n                    let subNode = resolveSection(pathSections[0]);\n                    if (pathSections.length === 1) {\n                        var resultNodes = subNode.nodes;\n                        if (resultNodes.length === 0) {\n                            //handling pseudo properties of literals\n                            if (node.nodes[0].language) {\n                                if (RDF2h.resolveCurie(pathSections[0]).equals(rdf.sym(\"http://purl.org/dc/terms/language\"))) {\n                                    return [rdf.literal(node.nodes[0].language)];\n                                }\n                            }\n                            if (node.nodes[0].datatype) {\n                                if (RDF2h.resolveCurie(pathSections[0]).equals(RDF2h.resolveCurie(\"rdf:type\"))) {\n                                    return [node.nodes[0].datatype];\n                                }\n                            }\n                        }\n                        return resultNodes;\n                    }\n                    return resolveSubPath(subNode,pathSections.slice(1))    \n                }\n                function splitPathSection(string) {\n                    let result = [];\n                    let readingURI = false;\n                    let lastCharLess = false;\n                    let section = \"\";\n                    function nextSection() {\n                        if (section.length > 0) {\n                            result.push(section);\n                            section = \"\";    \n                        }\n                    }\n                    for (var pos = 0; pos < string.length; pos++) {    \n                        let c = string[pos];\n                        if (lastCharLess) {\n                            if (c !== \"-\") {\n                                nextSection();\n                                readingURI = true;\n                            }\n                            section += \"<\";\n                            lastCharLess = false;\n                        }\n                        if (c === \"<\") {\n                            lastCharLess = true;\n                            continue;\n                        }\n                        if (readingURI && (c == \">\")) {\n                            section += c;\n                            nextSection();\n                            readingURI = false;\n                            continue;\n                        }\n                        if (!readingURI && (c == \"/\")) {\n                            nextSection();\n                            continue;\n                        }\n                        section += c;\n                    }\n                    nextSection();\n                    return result;\n                }\n                var pathSections = splitPathSection(path);// .split(\"/\").filter(function(e) { return e.length > 0})\n                return resolveSubPath(graphNode, pathSections);\n            }\n            if (name.startsWith(\"@prefix \")) {\n                var splits = name.split(\" \");\n                var prefixPart = splits[1];\n                var iriPart = splits[2];\n                var prefix = prefixPart.substring(0, prefixPart.length -1);\n                var iri = iriPart.substring(1, iriPart.length -1);\n                RDF2h.prefixMap[prefix] = iri;\n                return \"\";\n            }\n            if (name.startsWith(\":render \")) {\n                var splits = name.split(\" \");\n                var nodePath = splits[1];\n                var subContext = splits[2];\n                if (subContext) {\n                    subContext = RDF2h.resolveCurie(subContext);\n                }\n                if (!subContext) {\n                    subContext = context;\n                }\n                var resolvedNodes = resolvePath(nodePath);\n                if (resolvedNodes.length > 1) {\n                    console.warn(\"Argument of render evaluates to more than one node!\")\n                }\n                if (resolvedNodes.length > 0) {\n                    return rdf2h.render(graph, resolvedNodes[0], subContext)\n                } else {\n                    return \"\";\n                }\n            }\n            if (name.startsWith(\":continue\")) {\n                var splits = name.split(\" \");\n                var subContext = splits[1];\n                if (subContext) {\n                    subContext = RDF2h.resolveCurie(subContext);\n                }\n                if (!subContext) {\n                    subContext = context;\n                }\n                if (graphNode.nodes.length > 1) {\n                    console.warn(\":continue invoked in context with more than one node, this shouldn't be possible!\")\n                }\n                return rdf2h.render(graph, graphNode.nodes[0], subContext);\n\n            }\n            if (name.startsWith(\"+\")) {\n                name = name.substring(1);\n                return (resolvePath(name).length > 0);\n            }\n            var nodes = resolvePath(name);\n            if (nodes.length === 1) {\n                return new RDF2h.Renderee(rdf2h, GraphNode(nodes[0], graph), context);\n            } else {\n                return nodes.map(function (node) {\n                    return new RDF2h.Renderee(rdf2h, GraphNode(node, graph), context);\n                });\n            }\n            /*var node = this.view;\n             if (name === \".\") {\n             return node;\n             } else {\n             return \"not supported: \"+name;\n             }*/\n        } else {\n            return origLokup.call(this, name);\n        }\n    };\n})();\n\nRDF2h.Renderee = function (rdf2h, graphNode, context) {\n    if (!graphNode.nodes) {\n        throw new Error(\"second argument must be a GraphNode\");\n    }\n    if (graphNode.nodes.length !== 1) {\n        throw new Error(\"Renderee must be a single node\");\n    }\n    this.rdf2h = rdf2h;\n    this.graphNode = graphNode;\n    this.context = context;\n};\n\nRDF2h.Renderee.prototype.toString = function () {\n    if (this.graphNode.value) {\n        return this.graphNode.value;\n    }\n    return this.graphNode.toString();\n}\n\nRDF2h.prototype.getRenderer = function (renderee) {\n    var r2h = vocab.rdf2h;\n    let tbox = this.tbox;\n    function matchesContext(cfRenderer) {\n        var contexts = cfRenderer.out(r2h(\"context\")).nodes;\n        if (contexts.length === 0) {\n            console.debug(\"renderer \"+cfRenderer+\" specifies no context, thus accepting it for \"+renderee.context);\n            return true;\n        }\n        return contexts.some(function(context) {\n            if (renderee.context.equals(context)) {\n                console.debug(\"renderer \"+cfRenderer+\" matches the context \"+renderee.context);\n                return true;\n            }\n        });\n    }\n    function resolveRendererNode(rendererURI) {\n        if (!window) {\n            return \"Could not get renderer: \" + rendererURI + \", no window object.\"\n        }\n        var pageURIPrefix = window.location + \"#\";\n        if (!rendererURI.startsWith(pageURIPrefix)) {\n            return \"Could not get renderer: \" + rendererURI + \", the prefix must be \" + pageURIPrefix + \".\"\n        }\n        var id = rendererURI.substring(pageURIPrefix.length);\n        return document.getElementById(id).textContent;\n    }\n    function rendererRenderer(renderer) {\n        return function (renderee) {\n            return Mustache.render(renderer, renderee);\n        };\n    }\n    function getTypes(graphNode) {\n        //the array might contain rdfs:Resource twice (at the end)\n        return graphNode.out(vocab.rdf(\"type\")).nodes.sort(\n            (a,b) => {\n                if (a.equals(b)) {\n                    return 0;\n                }\n                if (a.equals(vocab.rdfs(\"Resource\"))) {\n                    return 1;\n                }\n                if (b.equals(vocab.rdfs(\"Resource\"))) {\n                    return -1;\n                }\n                if (tbox.match(a, vocab.rdfs(\"subClassOf\"),b).length === 0) {\n                    if (tbox.match(b, vocab.rdfs(\"subClassOf\"),a).length === 0) {\n                        return a.value.localeCompare(b.value);\n                    } else {\n                        return 1;\n                    }\n                } else {\n                    return -1;\n                }\n            }\n        ).concat([vocab.rdfs(\"Resource\")]);\n    }\n    function getMatchingRenderer(types, context) {\n        function getMatching(renderers) {\n            return renderers.find(renderer => context.equals(renderer.out(vocab.rdf2h(\"context\")).node));\n        }\n        return [false].concat(types).reduce((renderer, type) => \n            renderer ? renderer : getMatching(type.in(vocab.rdf2h(\"type\")).split()));\n    }\n    let types = getTypes(renderee.graphNode).map(t => GraphNode(t, this.rendererGraph));\n    let renderer = getMatchingRenderer(types, renderee.context);\n    if (!renderer) {\n        throw Error(\"No renderer found with context: <\"+renderee.context.value+\"> for any of the types \"+types.map(t => \"<\"+t.value+\">\").join()\n                    +\". The resource <\"+renderee.graphNode.value+\"> could thus not be rendered.\");\n    }\n    let mustache = renderer.out(vocab.rdf2h(\"mustache\"));\n    if (mustache.nodes.length > 0) {\n        return rendererRenderer(mustache.value);\n    }\n    let js = renderer.out(vocab.rdf2h(\"javaScript\"))\n    return function (renderee) {\n        try {\n            let render =  (n, context) => {\n                return renderee.rdf2h.render(n.graph, n.node, context ? context : renderee.context);\n            };\n            let output = \"\";\n            let print = (s) => {\n                output += s;\n            };\n            //Also printing return value for now\n            let returnValue = (new Function(\"n\", \"context\", \"$rdf\", \"render\", \"print\", \"GraphNode\", \"env\", js.value)\n                    )(renderee.graphNode, renderee.context, rdf, render, print, GraphNode, renderee.rdf2h.env);\n            if (returnValue) {\n                return output + returnValue;\n            } else {\n                return output;\n            }\n        } catch(err) {\n            err.message = err.message + \" in \" + js.value;\n            let stackLines = err.stack.split(\"\\n\");\n            let lineWithSelf = stackLines.findIndex(l => l.indexOf(\"RDF2h.render\") > 0);\n            err.stack = stackLines.splice(0, lineWithSelf - 1).join(\"\\n\");\n            throw err;\n        }\n    };\n\n\n}\n\nRDF2h.prototype.render = function (graph, node, context) {\n    if (!node.termType) {\n        node = rdf.sym(node);\n    }\n    if (!context) {\n        context = vocab.rdf2h(\"Default\");\n    }\n    //wrap all in one object that gets special care by lookup\n    var renderee = new RDF2h.Renderee(this, GraphNode(node, graph), context);\n    var renderer = this.getRenderer(renderee);\n    return renderer(renderee);\n}\n\nRDF2h.prefixMap = {};\nRDF2h.prefixMap[\"rdf\"] = \"http://www.w3.org/1999/02/22-rdf-syntax-ns#\";\nRDF2h.prefixMap[\"rdfs\"] = \"http://www.w3.org/2000/01/rdf-schema#\";\nRDF2h.prefixMap[\"r2h\"] = \"http://rdf2h.github.io/2015/rdf2h#\";\nRDF2h.prefixMap[\"schema\"] = \"http://schema.org/\";\nRDF2h.prefixMap[\"rdf\"] = \"http://www.w3.org/1999/02/22-rdf-syntax-ns#\";\nRDF2h.prefixMap[\"dct\"] = \"http://purl.org/dc/terms/\";\n\n\nRDF2h.resolveCurie = function (curie) {\n    if (curie.startsWith(\"<\") && curie.endsWith(\">\")) {\n        //URI, not a curie\n        return rdf.sym(curie.substring(1, curie.length - 1));\n    }\n    var splits = curie.split(\":\");\n    var prefix = splits[0];\n    var suffix = splits[1];\n    if (RDF2h.prefixMap[prefix]) {\n        return rdf.sym(RDF2h.prefixMap[prefix] + suffix);\n    } else {\n        return rdf.sym(curie);\n    }\n\n};\n\nif (typeof window !== 'undefined') {\n    window.RDF2h = RDF2h;\n}\n\nif (typeof module !== 'undefined') {\n    module.exports = RDF2h;\n}\n"],"sourceRoot":""}