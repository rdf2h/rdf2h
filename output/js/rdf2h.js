!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t){e.exports=$rdf},function(e,t,r){"use strict";function n(e,t){function r(e){return o.sym("http://rdf2h.github.io/2015/rdf2h#"+e)}console.info("RDF2h created"),this.matcherGraph=e,this.tbox=t||e;var n=new Array,i=o.sym("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),s=r("Matcher");e.statementsMatching(null,i,s).forEach(function(e){n.push(e.subject)});var u=r("before"),a=e.statementsMatching(null,u);a.forEach(function(e){n.push(e.subject),n.push(e.object)}),this.sortedMatchers=[];for(var h=this;n.length>0;)if(!n.some(function(e){return h.sortedMatchers.push(e),n=n.filter(function(t){return!t.equals(e)}),!0})){console.error("Circle Detected with:\n"+a.toString());break}console.debug("Constructed RDF2h with the following matchers: ",this.sortedMatchers.map(function(e){return e.toString()}))}var o=r(0),i=r(2),s=r(3),u=r(4);new Array;!function(){var e=(u.rdf2h,s.Context.prototype.lookup);s.Context.prototype.lookup=function(t){if(this.view instanceof n.Renderee){var r=function(e){function t(e,r){var i=function(t){return"."===t?e:t.endsWith("<-")?e.in(n.resolveCurie(t.substring(0,t.length-2))):t.startsWith("^")?e.in(n.resolveCurie(t.substring(1))):e.out(n.resolveCurie(t))}(r[0]);if(1===r.length){var s=i.nodes;if(0===s.length){if(e.nodes[0].language&&n.resolveCurie(r[0]).equals(o.sym("http://purl.org/dc/terms/language")))return[o.literal(e.nodes[0].language)];if(e.nodes[0].datatype&&n.resolveCurie(r[0]).equals(n.resolveCurie("rdf:type")))return[e.nodes[0].datatype]}return s}return t(i,r.slice(1))}var r=function(e){function t(){i.length>0&&(r.push(i),i="")}for(var r=[],n=!1,o=!1,i="",s=0;s<e.length;s++){var u=e[s];o&&("-"!==u&&(t(),n=!0),i+="<",o=!1),"<"!==u?n&&">"==u?(i+=u,t(),n=!1):n||"/"!=u?i+=u:t():o=!0}return t(),r}(e);return t(u,r)},s=this.view.rdf2h,u=this.view.graphNode,a=u.graph,h=this.view.context,c=this.view.currentMatcherIndex;if(t.startsWith("@prefix ")){var f=t.split(" "),p=f[1],l=f[2],d=p.substring(0,p.length-1),g=l.substring(1,l.length-1);return n.prefixMap[d]=g,""}if(t.startsWith(":render ")){var f=t.split(" "),v=f[1],y=f[2];y&&(y=n.resolveCurie(y)),y||(y=h);var w=r(v);return w.length>1&&console.warn("Argument of render evaluates to more than one node!"),w.length>0?s.render(a,w[0],y):""}if(t.startsWith(":continue")){var f=t.split(" "),y=f[1];return y&&(y=n.resolveCurie(y)),y||(y=h),u.nodes.length>1&&console.warn(":continue invoked in context with more than one node, this shouldn't be possible!"),s.render(a,u.nodes[0],y,c+1)}if(t.startsWith("+"))return t=t.substring(1),r(t).length>0;var m=r(t);return 1===m.length?new n.Renderee(s,i(m[0],a),h):m.map(function(e){return new n.Renderee(s,i(e,a),h)})}return e.call(this,t)}}(),n.Renderee=function(e,t,r){if(!t.nodes)throw new Error("second argument must be a GraphNode");if(1!==t.nodes.length)throw new Error("Renderee must be a single node");this.rdf2h=e,this.graphNode=t,this.context=r},n.Renderee.prototype.toString=function(){return this.graphNode.value?this.graphNode.value:this.graphNode.toString()},n.prototype.getRenderer=function(e){var t=this,r=(u.rdf2h,this.tbox),n=function(e){return e.out(u.rdf("type")).nodes.sort(function(e,t){return e.equals(t)?0:e.equals(u.rdfs("Resource"))?1:t.equals(u.rdfs("Resource"))?-1:0===r.match(e,u.rdfs("subClassOf"),t).length?0===r.match(t,u.rdfs("subClassOf"),e).length?e.value.localeCompare(t.value):1:-1}).concat([u.rdfs("Resource")])}(e.graphNode).map(function(e){return i(e,t.matcherGraph)}),a=function(e,t){function r(e){return e.find(function(e){return t.equals(e.out(u.rdf2h("context")).node)})}return[!1].concat(e).reduce(function(e,t){return e||r(t.in(u.rdf2h("type")).split())})}(n,e.context);if(!a)throw Error("No template found with context: "+e.context+" for any of the types "+n.map(function(e){return"<"+e.value+">"}).join()+". The resource <"+e.graphNode.value+"> could thus not be rendered.");var h=a.out(u.rdf2h("mustache"));if(h.nodes.length>0)return function(e){return function(t){return s.render(e,t)}}(h.value);var c=a.out(u.rdf2h("javaScript"));return function(e){try{return new Function("n","$rdf",c.value)(e.graphNode,o)}catch(e){e.message=e.message+" in "+c.value;var t=e.stack.split("\n"),r=t.findIndex(function(e){return e.indexOf("RDF2h.render")>0});throw e.stack=t.splice(0,r-1).join("\n"),e}}},n.prototype.render=function(e,t,r,s){t.termType||(t=o.sym(t)),r||(r=u.rdf2h("Default"));var a=new n.Renderee(this,i(t,e),r);return this.startMatcherIndex=s||0,this.getRenderer(a)(a)},n.prefixMap={},n.prefixMap.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#",n.prefixMap.rdfs="http://www.w3.org/2000/01/rdf-schema#",n.prefixMap.r2h="http://rdf2h.github.io/2015/rdf2h#",n.prefixMap.schema="http://schema.org/",n.prefixMap.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#",n.prefixMap.dct="http://purl.org/dc/terms/",n.resolveCurie=function(e){if(e.startsWith("<")&&e.endsWith(">"))return o.sym(e.substring(1,e.length-1));console.debug("resolving "+e);var t=e.split(":"),r=t[0],i=t[1];return n.prefixMap[r]?o.sym(n.prefixMap[r]+i):o.sym(e)},"undefined"!=typeof window&&(window.RDF2h=n),e.exports=n},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){return new(Function.prototype.bind.apply(o.Impl,[null].concat(Array.prototype.slice.call(arguments))))}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();if(void 0===s)var s=r(0);o.Impl=function(){function e(t,r,o){n(this,e),this._graph=r,Array.isArray(t)?this.nodes=t:this.nodes=[t],this.sources=o}return i(e,[{key:"fetch",value:function(){var e=this;if("NamedNode"!==this.termType||this.sources&&this.sources.indexOf(this.value.split("#")[0])>-1)return Promise.resolve(this);var t=this.value.split("#")[0];return o.rdfFetch(t).then(function(r){return o(e.node,r.graph,[t])})}},{key:"each",value:function(e){var t=this,r=this.nodes.map(function(r){return e(o([r],t.graph,t.sources))});return Promise.all(r)}},{key:"fetchEach",value:function(e){var t=this,r=this.nodes.map(function(r){return o([r],t.graph,t.sources).fetch().then(e)});return Promise.all(r)}},{key:"split",value:function(){var e=this;return this.nodes.map(function(t){return o([t],e.graph,e.sources)})}},{key:"out",value:function(e){return o(this.graph.each(this.node,e),this.graph,this.sources)}},{key:"in",value:function(e){return o(this.graph.statementsMatching(void 0,e,this.node).map(function(e){return e.subject}),this.graph,this.sources)}},{key:"graph",get:function(){if(!this._graph)throw Error("Operation not possible as no Graph is available, try fetching first");return this._graph}},{key:"node",get:function(){if(1!==this.nodes.length)throw Error("Operation not possible as this GraphNode is underdetermined");return this.nodes[0]}},{key:"termType",get:function(){return this.node.termType}},{key:"value",get:function(){return this.node.value}}]),e}(),o.rdfFetch=function(e,t,r){var n=this;return new Promise(function(o,i){var u=s.graph();new s.Fetcher(u,t).fetch(e,{redirect:"follow"}).then(function(t){if(t.status<300)t.graph=u,o(t);else{if(r&&401===t.status)return console.log("Got 401 response, attempting to login"),r().then(function(){return n.rdfFetch(e)});i(t)}})})},e.exports=o},function(e,t,r){"use strict";var n,o,i,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
!function(r,u){"object"===s(t)&&t&&"string"!=typeof t.nodeName?u(t):(o=[t],n=u,void 0!==(i="function"==typeof n?n.apply(t,o):n)&&(e.exports=i))}(0,function(e){function t(e){return"function"==typeof e}function r(e){return v(e)?"array":void 0===e?"undefined":s(e)}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(e,t){return null!=e&&"object"===(void 0===e?"undefined":s(e))&&t in e}function i(e,t){return y.call(e,t)}function u(e){return!i(w,e)}function a(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return m[e]})}function h(t,r){function o(e){if("string"==typeof e&&(e=e.split(x,2)),!v(e)||2!==e.length)throw new Error("Invalid tags: "+e);i=new RegExp(n(e[0])+"\\s*"),s=new RegExp("\\s*"+n(e[1])),a=new RegExp("\\s*"+n("}"+e[1]))}if(!t)return[];var i,s,a,h=[],l=[],d=[],g=!1,y=!1;o(r||e.tags);for(var w,m,M,R,j,S,T=new p(t);!T.eos();){if(w=T.pos,M=T.scanUntil(i))for(var N=0,O=M.length;N<O;++N)R=M.charAt(N),u(R)?d.push(l.length):y=!0,l.push(["text",R,w,w+1]),w+=1,"\n"===R&&function(){if(g&&!y)for(;d.length;)delete l[d.pop()];else d=[];g=!1,y=!1}();if(!T.scan(i))break;if(g=!0,m=T.scan(E)||"name",T.scan(b),"="===m?(M=T.scanUntil(k),T.scan(k),T.scanUntil(s)):"{"===m?(M=T.scanUntil(a),T.scan(C),T.scanUntil(s),m="&"):M=T.scanUntil(s),!T.scan(s))throw new Error("Unclosed tag at "+T.pos);if(j=[m,M,w,T.pos],l.push(j),"#"===m||"^"===m)h.push(j);else if("/"===m){if(!(S=h.pop()))throw new Error('Unopened section "'+M+'" at '+w);if(S[1]!==M)throw new Error('Unclosed section "'+S[1]+'" at '+w)}else"name"===m||"{"===m||"&"===m?y=!0:"="===m&&o(M)}if(S=h.pop())throw new Error('Unclosed section "'+S[1]+'" at '+T.pos);return f(c(l))}function c(e){for(var t,r,n=[],o=0,i=e.length;o<i;++o)(t=e[o])&&("text"===t[0]&&r&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(n.push(t),r=t));return n}function f(e){for(var t,r,n=[],o=n,i=[],s=0,u=e.length;s<u;++s)switch(t=e[s],t[0]){case"#":case"^":o.push(t),i.push(t),o=t[4]=[];break;case"/":r=i.pop(),r[5]=t[2],o=i.length>0?i[i.length-1][4]:n;break;default:o.push(t)}return n}function p(e){this.string=e,this.tail=e,this.pos=0}function l(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function d(){this.cache={}}var g=Object.prototype.toString,v=Array.isArray||function(e){return"[object Array]"===g.call(e)},y=RegExp.prototype.test,w=/\S/,m={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},b=/\s*/,x=/\s+/,k=/\s*=/,C=/\s*\}/,E=/#|\^|\/|>|\{|&|=|!/;p.prototype.eos=function(){return""===this.tail},p.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},p.prototype.scanUntil=function(e){var t,r=this.tail.search(e);switch(r){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},l.prototype.push=function(e){return new l(e,this)},l.prototype.lookup=function(e){var r,n=this.cache;if(n.hasOwnProperty(e))r=n[e];else{for(var i,s,u=this,a=!1;u;){if(e.indexOf(".")>0)for(r=u.view,i=e.split("."),s=0;null!=r&&s<i.length;)s===i.length-1&&(a=o(r,i[s])),r=r[i[s++]];else r=u.view[e],a=o(u.view,e);if(a)break;u=u.parent}n[e]=r}return t(r)&&(r=r.call(this.view)),r},d.prototype.clearCache=function(){this.cache={}},d.prototype.parse=function(e,t){var r=this.cache,n=r[e];return null==n&&(n=r[e]=h(e,t)),n},d.prototype.render=function(e,t,r){var n=this.parse(e),o=t instanceof l?t:new l(t);return this.renderTokens(n,o,r,e)},d.prototype.renderTokens=function(e,t,r,n){for(var o,i,s,u="",a=0,h=e.length;a<h;++a)s=void 0,o=e[a],i=o[0],"#"===i?s=this.renderSection(o,t,r,n):"^"===i?s=this.renderInverted(o,t,r,n):">"===i?s=this.renderPartial(o,t,r,n):"&"===i?s=this.unescapedValue(o,t):"name"===i?s=this.escapedValue(o,t):"text"===i&&(s=this.rawValue(o)),void 0!==s&&(u+=s);return u},d.prototype.renderSection=function(e,r,n,o){function i(e){return u.render(e,r,n)}var u=this,a="",h=r.lookup(e[1]);if(h){if(v(h))for(var c=0,f=h.length;c<f;++c)a+=this.renderTokens(e[4],r.push(h[c]),n,o);else if("object"===(void 0===h?"undefined":s(h))||"string"==typeof h||"number"==typeof h)a+=this.renderTokens(e[4],r.push(h),n,o);else if(t(h)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");h=h.call(r.view,o.slice(e[3],e[5]),i),null!=h&&(a+=h)}else a+=this.renderTokens(e[4],r,n,o);return a}},d.prototype.renderInverted=function(e,t,r,n){var o=t.lookup(e[1]);if(!o||v(o)&&0===o.length)return this.renderTokens(e[4],t,r,n)},d.prototype.renderPartial=function(e,r,n){if(n){var o=t(n)?n(e[1]):n[e[1]];return null!=o?this.renderTokens(this.parse(o),r,n,o):void 0}},d.prototype.unescapedValue=function(e,t){var r=t.lookup(e[1]);if(null!=r)return r},d.prototype.escapedValue=function(t,r){var n=r.lookup(t[1]);if(null!=n)return e.escape(n)},d.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.0",e.tags=["{{","}}"];var M=new d;return e.clearCache=function(){return M.clearCache()},e.parse=function(e,t){return M.parse(e,t)},e.render=function(e,t,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+r(e)+'" was given as the first argument for mustache#render(template, view, partials)');return M.render(e,t,n)},e.to_html=function(r,n,o,i){var s=e.render(r,n,o);if(!t(i))return s;i(s)},e.escape=a,e.Scanner=p,e.Context=l,e.Writer=d,e})},function(e,t,r){"use strict";var n=r(0);e.exports={schema:function(e){return n.sym("http://schema.org/"+e)},rdf:function(e){return n.sym("http://www.w3.org/1999/02/22-rdf-syntax-ns#"+e)},rdfs:function(e){return n.sym("http://www.w3.org/2000/01/rdf-schema#"+e)},foaf:function(e){return n.sym("http://xmlns.com/foaf/0.1/"+e)},rdf2h:function(e){return n.sym("http://rdf2h.github.io/2015/rdf2h#"+e)}}}]);
//# sourceMappingURL=rdf2h.js.map